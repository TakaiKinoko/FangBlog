{
  "expireTime": 9007200830835968000,
  "key": "transformer-remark-markdown-ast-da6dd846419e2c0da0c9ac814e3cec4d-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-reading-time-",
  "val": {
    "type": "root",
    "children": [
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "This post talks about a key factor to CUDA kernel performace: accessing data in the globle memory.",
            "position": {
              "start": { "line": 2, "column": 1, "offset": 1 },
              "end": { "line": 2, "column": 99, "offset": 99 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 2, "column": 1, "offset": 1 },
          "end": { "line": 2, "column": 99, "offset": 99 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "CUDA applications tend to process a massive amount of data from the global memory within a short period of time.",
            "position": {
              "start": { "line": 4, "column": 1, "offset": 101 },
              "end": { "line": 4, "column": 113, "offset": 213 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 4, "column": 1, "offset": 101 },
          "end": { "line": 4, "column": 113, "offset": 213 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "Tiling",
                "position": {
                  "start": { "line": 6, "column": 3, "offset": 217 },
                  "end": { "line": 6, "column": 9, "offset": 223 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 6, "column": 1, "offset": 215 },
              "end": { "line": 6, "column": 11, "offset": 225 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " techniques are engineered that utilize ",
            "position": {
              "start": { "line": 6, "column": 11, "offset": 225 },
              "end": { "line": 6, "column": 51, "offset": 265 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "shared memories",
                "position": {
                  "start": { "line": 6, "column": 53, "offset": 267 },
                  "end": { "line": 6, "column": 68, "offset": 282 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 6, "column": 51, "offset": 265 },
              "end": { "line": 6, "column": 70, "offset": 284 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " to reduce the total amount of data that must be acessed from the global memory (read about tiling techniques here ",
            "position": {
              "start": { "line": 6, "column": 70, "offset": 284 },
              "end": { "line": 6, "column": 185, "offset": 399 },
              "indent": []
            }
          },
          {
            "type": "link",
            "title": null,
            "url": "/cuda6-tiling",
            "children": [
              {
                "type": "text",
                "value": "The CUDA Parallel Programming Model - 6.Tiling",
                "position": {
                  "start": { "line": 6, "column": 186, "offset": 400 },
                  "end": { "line": 6, "column": 232, "offset": 446 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 6, "column": 185, "offset": 399 },
              "end": { "line": 6, "column": 248, "offset": 462 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ").",
            "position": {
              "start": { "line": 6, "column": 248, "offset": 462 },
              "end": { "line": 6, "column": 250, "offset": 464 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 6, "column": 1, "offset": 215 },
          "end": { "line": 6, "column": 250, "offset": 464 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In this post I’d like to introduce ",
            "position": {
              "start": { "line": 8, "column": 1, "offset": 466 },
              "end": { "line": 8, "column": 36, "offset": 501 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "memory coalescing",
                "position": {
                  "start": { "line": 8, "column": 38, "offset": 503 },
                  "end": { "line": 8, "column": 55, "offset": 520 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 8, "column": 36, "offset": 501 },
              "end": { "line": 8, "column": 57, "offset": 522 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " techniques that can more effectively move data from the global memory into ",
            "position": {
              "start": { "line": 8, "column": 57, "offset": 522 },
              "end": { "line": 8, "column": 133, "offset": 598 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "shared memories and registers",
                "position": {
                  "start": { "line": 8, "column": 135, "offset": 600 },
                  "end": { "line": 8, "column": 164, "offset": 629 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 8, "column": 133, "offset": 598 },
              "end": { "line": 8, "column": 166, "offset": 631 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 8, "column": 166, "offset": 631 },
              "end": { "line": 8, "column": 167, "offset": 632 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 8, "column": 1, "offset": 466 },
          "end": { "line": 8, "column": 167, "offset": 632 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Memory coalescing techniques are often used ",
            "position": {
              "start": { "line": 10, "column": 1, "offset": 634 },
              "end": { "line": 10, "column": 45, "offset": 678 },
              "indent": []
            }
          },
          {
            "type": "emphasis",
            "children": [
              {
                "type": "text",
                "value": "in conjunction with tiling techniques",
                "position": {
                  "start": { "line": 10, "column": 46, "offset": 679 },
                  "end": { "line": 10, "column": 83, "offset": 716 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 10, "column": 45, "offset": 678 },
              "end": { "line": 10, "column": 84, "offset": 717 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " to allow CUDA devices to reach their performance potential by more efficiently utilizing the global memory bandwidth.",
            "position": {
              "start": { "line": 10, "column": 84, "offset": 717 },
              "end": { "line": 10, "column": 202, "offset": 835 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 10, "column": 1, "offset": 634 },
          "end": { "line": 10, "column": 202, "offset": 835 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Global Memory Bandwidth",
            "position": {
              "start": { "line": 12, "column": 4, "offset": 840 },
              "end": { "line": 12, "column": 27, "offset": 863 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 12, "column": 1, "offset": 837 },
          "end": { "line": 12, "column": 27, "offset": 863 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The global memory of a CUDA device is implemented with DRAMs.",
            "position": {
              "start": { "line": 14, "column": 1, "offset": 865 },
              "end": { "line": 14, "column": 62, "offset": 926 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 14, "column": 1, "offset": 865 },
          "end": { "line": 14, "column": 62, "offset": 926 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "DRAM is slow",
            "position": {
              "start": { "line": 16, "column": 6, "offset": 933 },
              "end": { "line": 16, "column": 18, "offset": 945 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 16, "column": 1, "offset": 928 },
          "end": { "line": 16, "column": 18, "offset": 945 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Data bits are stored in DRAM cells that are small capacitors, where the presence or absence of a ",
            "position": {
              "start": { "line": 18, "column": 1, "offset": 947 },
              "end": { "line": 18, "column": 98, "offset": 1044 },
              "indent": []
            }
          },
          {
            "type": "emphasis",
            "children": [
              {
                "type": "text",
                "value": "tiny amount of electrical charge",
                "position": {
                  "start": { "line": 18, "column": 99, "offset": 1045 },
                  "end": { "line": 18, "column": 131, "offset": 1077 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 18, "column": 98, "offset": 1044 },
              "end": { "line": 18, "column": 132, "offset": 1078 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " distinguishes between 0 and 1.",
            "position": {
              "start": { "line": 18, "column": 132, "offset": 1078 },
              "end": { "line": 18, "column": 163, "offset": 1109 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 18, "column": 1, "offset": 947 },
          "end": { "line": 18, "column": 163, "offset": 1109 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Reading data from a DRAM cell requires the small capacitor to use its tiny electrical charge to drive a highly capacitive line leading to a sensor and set off its detection mechanism that determines whether a sufficient amount of charge is present in the capacitor to qualify as a “1”. This process takes 10 s of nanoseconds in modern DRAM chips. ",
            "position": {
              "start": { "line": 20, "column": 1, "offset": 1111 },
              "end": { "line": 20, "column": 348, "offset": 1458 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "This is in sharp contrast with the sub-nanosecond clock cycle time of modern computing devices",
                "position": {
                  "start": { "line": 20, "column": 350, "offset": 1460 },
                  "end": { "line": 20, "column": 444, "offset": 1554 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 20, "column": 348, "offset": 1458 },
              "end": { "line": 20, "column": 446, "offset": 1556 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 20, "column": 446, "offset": 1556 },
              "end": { "line": 20, "column": 447, "offset": 1557 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 20, "column": 1, "offset": 1111 },
          "end": { "line": 20, "column": 447, "offset": 1557 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "parallelism and memory access throughput",
            "position": {
              "start": { "line": 22, "column": 6, "offset": 1564 },
              "end": { "line": 22, "column": 46, "offset": 1604 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 22, "column": 1, "offset": 1559 },
          "end": { "line": 22, "column": 46, "offset": 1604 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Because this is a very slow process relative to the desired data access speed (sub-nanosecond access per byte), modern DRAMs ",
            "position": {
              "start": { "line": 24, "column": 1, "offset": 1606 },
              "end": { "line": 24, "column": 126, "offset": 1731 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "use parallelism to increase their rate of data access",
                "position": {
                  "start": { "line": 24, "column": 128, "offset": 1733 },
                  "end": { "line": 24, "column": 181, "offset": 1786 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 24, "column": 126, "offset": 1731 },
              "end": { "line": 24, "column": 183, "offset": 1788 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", commonly referred to as ",
            "position": {
              "start": { "line": 24, "column": 183, "offset": 1788 },
              "end": { "line": 24, "column": 209, "offset": 1814 },
              "indent": []
            }
          },
          {
            "type": "emphasis",
            "children": [
              {
                "type": "text",
                "value": "memory access throughput",
                "position": {
                  "start": { "line": 24, "column": 210, "offset": 1815 },
                  "end": { "line": 24, "column": 234, "offset": 1839 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 24, "column": 209, "offset": 1814 },
              "end": { "line": 24, "column": 235, "offset": 1840 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 24, "column": 235, "offset": 1840 },
              "end": { "line": 24, "column": 236, "offset": 1841 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 24, "column": 1, "offset": 1606 },
          "end": { "line": 24, "column": 236, "offset": 1841 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "DRAM bursts",
            "position": {
              "start": { "line": 26, "column": 6, "offset": 1848 },
              "end": { "line": 26, "column": 17, "offset": 1859 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 26, "column": 1, "offset": 1843 },
          "end": { "line": 26, "column": 17, "offset": 1859 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Each time a DRAM location is accessed, ",
            "position": {
              "start": { "line": 28, "column": 1, "offset": 1861 },
              "end": { "line": 28, "column": 40, "offset": 1900 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "a range of consecutive locations that includes the requested location are actually accessed",
                "position": {
                  "start": { "line": 28, "column": 42, "offset": 1902 },
                  "end": { "line": 28, "column": 133, "offset": 1993 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 28, "column": 40, "offset": 1900 },
              "end": { "line": 28, "column": 135, "offset": 1995 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 28, "column": 135, "offset": 1995 },
              "end": { "line": 28, "column": 136, "offset": 1996 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 28, "column": 1, "offset": 1861 },
          "end": { "line": 28, "column": 136, "offset": 1996 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Many sensors are provided in each DRAM chip and they work in parallel, each senses the content of a bit within these consecutive locations.",
            "position": {
              "start": { "line": 30, "column": 1, "offset": 1998 },
              "end": { "line": 30, "column": 140, "offset": 2137 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 30, "column": 1, "offset": 1998 },
          "end": { "line": 30, "column": 140, "offset": 2137 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Once detected by the sensors, the data from all these consecutive locations can be transferred at very high-speed to the processor. These consecutive locations accessed and delivered are referred to as ",
            "position": {
              "start": { "line": 32, "column": 1, "offset": 2139 },
              "end": { "line": 32, "column": 203, "offset": 2341 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "DRAM bursts",
                "position": {
                  "start": { "line": 32, "column": 205, "offset": 2343 },
                  "end": { "line": 32, "column": 216, "offset": 2354 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 32, "column": 203, "offset": 2341 },
              "end": { "line": 32, "column": 218, "offset": 2356 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 32, "column": 218, "offset": 2356 },
              "end": { "line": 32, "column": 219, "offset": 2357 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 32, "column": 1, "offset": 2139 },
          "end": { "line": 32, "column": 219, "offset": 2357 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "motivation",
            "position": {
              "start": { "line": 34, "column": 6, "offset": 2364 },
              "end": { "line": 34, "column": 16, "offset": 2374 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 34, "column": 1, "offset": 2359 },
          "end": { "line": 34, "column": 16, "offset": 2374 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "If an application makes focused use of data from these bursts, the DRAMs can supply the data at a much higher rate than if a truly random sequence of locations were accessed.",
            "position": {
              "start": { "line": 36, "column": 1, "offset": 2376 },
              "end": { "line": 36, "column": 175, "offset": 2550 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 36, "column": 1, "offset": 2376 },
          "end": { "line": 36, "column": 175, "offset": 2550 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Memory Coalescing",
            "position": {
              "start": { "line": 38, "column": 4, "offset": 2555 },
              "end": { "line": 38, "column": 21, "offset": 2572 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 38, "column": 1, "offset": 2552 },
          "end": { "line": 38, "column": 21, "offset": 2572 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Current CUDA devices employ a technique that allows the programmers to achieve high global memory access efficiency by ",
            "position": {
              "start": { "line": 40, "column": 1, "offset": 2574 },
              "end": { "line": 40, "column": 120, "offset": 2693 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "organizing memory accesses of threads into favorable patterns",
                "position": {
                  "start": { "line": 40, "column": 122, "offset": 2695 },
                  "end": { "line": 40, "column": 183, "offset": 2756 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 40, "column": 120, "offset": 2693 },
              "end": { "line": 40, "column": 185, "offset": 2758 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ".",
            "position": {
              "start": { "line": 40, "column": 185, "offset": 2758 },
              "end": { "line": 40, "column": 186, "offset": 2759 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 40, "column": 1, "offset": 2574 },
          "end": { "line": 40, "column": 186, "offset": 2759 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "how?",
            "position": {
              "start": { "line": 42, "column": 5, "offset": 2765 },
              "end": { "line": 42, "column": 9, "offset": 2769 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 42, "column": 1, "offset": 2761 },
          "end": { "line": 42, "column": 9, "offset": 2769 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "This technique takes advantage of the fact that ",
                    "position": {
                      "start": { "line": 44, "column": 3, "offset": 2773 },
                      "end": { "line": 44, "column": 51, "offset": 2821 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "threads in a warp execute the same instruction at any given point in time",
                        "position": {
                          "start": { "line": 44, "column": 53, "offset": 2823 },
                          "end": { "line": 44, "column": 126, "offset": 2896 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 44, "column": 51, "offset": 2821 },
                      "end": { "line": 44, "column": 128, "offset": 2898 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ".",
                    "position": {
                      "start": { "line": 44, "column": 128, "offset": 2898 },
                      "end": { "line": 44, "column": 129, "offset": 2899 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 44, "column": 3, "offset": 2773 },
                  "end": { "line": 44, "column": 129, "offset": 2899 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 44, "column": 1, "offset": 2771 },
              "end": { "line": 45, "column": 1, "offset": 2900 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The most favorable access pattern is achieved when all threads in a warp access ",
                    "position": {
                      "start": { "line": 46, "column": 3, "offset": 2903 },
                      "end": { "line": 46, "column": 83, "offset": 2983 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "consecutive global memory locations",
                        "position": {
                          "start": { "line": 46, "column": 85, "offset": 2985 },
                          "end": { "line": 46, "column": 120, "offset": 3020 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 46, "column": 83, "offset": 2983 },
                      "end": { "line": 46, "column": 122, "offset": 3022 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ".",
                    "position": {
                      "start": { "line": 46, "column": 122, "offset": 3022 },
                      "end": { "line": 46, "column": 123, "offset": 3023 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 46, "column": 3, "offset": 2903 },
                  "end": { "line": 46, "column": 123, "offset": 3023 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 46, "column": 1, "offset": 2901 },
              "end": { "line": 47, "column": 1, "offset": 3024 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "When all threads in a warp execute a load instruction, the hardware detects whether they access consecutive global memory locations",
                        "position": {
                          "start": { "line": 48, "column": 5, "offset": 3029 },
                          "end": { "line": 48, "column": 136, "offset": 3160 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 48, "column": 3, "offset": 3027 },
                      "end": { "line": 48, "column": 138, "offset": 3162 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ". If that’s the case, the hardware combines (",
                    "position": {
                      "start": { "line": 48, "column": 138, "offset": 3162 },
                      "end": { "line": 48, "column": 183, "offset": 3207 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "coalesces",
                        "position": {
                          "start": {
                            "line": 48,
                            "column": 185,
                            "offset": 3209
                          },
                          "end": { "line": 48, "column": 194, "offset": 3218 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 48, "column": 183, "offset": 3207 },
                      "end": { "line": 48, "column": 196, "offset": 3220 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ") all these accesses into a consolidated access to consecutive DRAM locations.",
                    "position": {
                      "start": { "line": 48, "column": 196, "offset": 3220 },
                      "end": { "line": 48, "column": 274, "offset": 3298 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 48, "column": 3, "offset": 3027 },
                  "end": { "line": 48, "column": 274, "offset": 3298 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 48, "column": 1, "offset": 3025 },
              "end": { "line": 49, "column": 1, "offset": 3299 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "For example, for a given load instruction of a warp, if thread 0 accesses global memory location N2, thread 1 location N+1, thread 2 location N+2, and so on, all these accesses will be coalesced into a single request for consecutive locations when accessing the DRAMs.",
                    "position": {
                      "start": { "line": 50, "column": 3, "offset": 3302 },
                      "end": { "line": 50, "column": 271, "offset": 3570 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 50, "column": 3, "offset": 3302 },
                  "end": { "line": 50, "column": 271, "offset": 3570 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 50, "column": 1, "offset": 3300 },
              "end": { "line": 51, "column": 1, "offset": 3571 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Such coalesced access allows the DRAMs to deliver data as a burst.",
                    "position": {
                      "start": { "line": 52, "column": 3, "offset": 3574 },
                      "end": { "line": 52, "column": 69, "offset": 3640 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 52, "column": 3, "offset": 3574 },
                  "end": { "line": 52, "column": 69, "offset": 3640 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 52, "column": 1, "offset": 3572 },
              "end": { "line": 52, "column": 69, "offset": 3640 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 44, "column": 1, "offset": 2771 },
          "end": { "line": 52, "column": 69, "offset": 3640 },
          "indent": [1, 1, 1, 1, 1, 1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "matrix multiplication example",
            "position": {
              "start": { "line": 54, "column": 5, "offset": 3646 },
              "end": { "line": 54, "column": 34, "offset": 3675 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 54, "column": 1, "offset": 3642 },
          "end": { "line": 54, "column": 34, "offset": 3675 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Recall from ",
            "position": {
              "start": { "line": 56, "column": 1, "offset": 3677 },
              "end": { "line": 56, "column": 13, "offset": 3689 },
              "indent": []
            }
          },
          {
            "type": "link",
            "title": null,
            "url": "/cuda2-warp",
            "children": [
              {
                "type": "text",
                "value": "The CUDA Parallel Programming Model - 2. Warps",
                "position": {
                  "start": { "line": 56, "column": 14, "offset": 3690 },
                  "end": { "line": 56, "column": 60, "offset": 3736 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 56, "column": 13, "offset": 3689 },
              "end": { "line": 56, "column": 74, "offset": 3750 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " that multidimensional array elements in CUDA are placed into the linearized addressed memory space according to the ",
            "position": {
              "start": { "line": 56, "column": 74, "offset": 3750 },
              "end": { "line": 56, "column": 191, "offset": 3867 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "row-major",
                "position": {
                  "start": { "line": 56, "column": 193, "offset": 3869 },
                  "end": { "line": 56, "column": 202, "offset": 3878 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 56, "column": 191, "offset": 3867 },
              "end": { "line": 56, "column": 204, "offset": 3880 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " convention.",
            "position": {
              "start": { "line": 56, "column": 204, "offset": 3880 },
              "end": { "line": 56, "column": 216, "offset": 3892 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 56, "column": 1, "offset": 3677 },
          "end": { "line": 56, "column": 216, "offset": 3892 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Say we have a kernel that computes ",
            "position": {
              "start": { "line": 58, "column": 1, "offset": 3894 },
              "end": { "line": 58, "column": 36, "offset": 3929 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">M x N</code>",
            "position": {
              "start": { "line": 58, "column": 36, "offset": 3929 },
              "end": { "line": 58, "column": 43, "offset": 3936 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", where both M and N are 2D row-major array.",
            "position": {
              "start": { "line": 58, "column": 43, "offset": 3936 },
              "end": { "line": 58, "column": 87, "offset": 3980 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 58, "column": 1, "offset": 3894 },
          "end": { "line": 58, "column": 87, "offset": 3980 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Each thread accesses a row of the M array (matrix A below) and a column of the N array (matrix B below).",
            "position": {
              "start": { "line": 60, "column": 1, "offset": 3982 },
              "end": { "line": 60, "column": 105, "offset": 4086 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 60, "column": 1, "offset": 3982 },
          "end": { "line": 60, "column": 105, "offset": 4086 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "IMPORTANT: hope this helps with understanding the patterns below",
            "position": {
              "start": { "line": 62, "column": 5, "offset": 4092 },
              "end": { "line": 62, "column": 69, "offset": 4156 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 62, "column": 1, "offset": 4088 },
          "end": { "line": 62, "column": 69, "offset": 4156 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Coalesce happens amongst threads, not amongst different iterations of the loop within each thread’s execution.",
            "position": {
              "start": { "line": 64, "column": 1, "offset": 4158 },
              "end": { "line": 64, "column": 111, "offset": 4268 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 64, "column": 1, "offset": 4158 },
          "end": { "line": 64, "column": 111, "offset": 4268 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You might be thinking: for matrix M in the example below, each thread will read the whole row within its for-loop. But it’s not how the coalesce hardware works here.",
            "position": {
              "start": { "line": 66, "column": 1, "offset": 4270 },
              "end": { "line": 66, "column": 166, "offset": 4435 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 66, "column": 1, "offset": 4270 },
          "end": { "line": 66, "column": 166, "offset": 4435 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Because:",
            "position": {
              "start": { "line": 68, "column": 1, "offset": 4437 },
              "end": { "line": 68, "column": 9, "offset": 4445 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 68, "column": 1, "offset": 4437 },
          "end": { "line": 68, "column": 9, "offset": 4445 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "if you look across the threads in matrix M, they don’t share row accesses at all.",
                    "position": {
                      "start": { "line": 70, "column": 3, "offset": 4449 },
                      "end": { "line": 70, "column": 84, "offset": 4530 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 70, "column": 3, "offset": 4449 },
                  "end": { "line": 70, "column": 84, "offset": 4530 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 70, "column": 1, "offset": 4447 },
              "end": { "line": 70, "column": 84, "offset": 4530 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "whereas for matrix N, each thread at iteration 0 combined will access the entire row 0.",
                    "position": {
                      "start": { "line": 71, "column": 3, "offset": 4533 },
                      "end": { "line": 71, "column": 90, "offset": 4620 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 71, "column": 3, "offset": 4533 },
                  "end": { "line": 71, "column": 90, "offset": 4620 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 71, "column": 1, "offset": 4531 },
              "end": { "line": 71, "column": 90, "offset": 4620 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 70, "column": 1, "offset": 4447 },
          "end": { "line": 71, "column": 90, "offset": 4620 },
          "indent": [1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Since all threads within a warp executes the same instruction, they all execute the same iteration in the loop at any time. So it doesn’t matter if a thread reads through an entire row during its lifetime. What matters is that all the threads of a warp can be coalesced during each (collected) memory access.",
            "position": {
              "start": { "line": 73, "column": 1, "offset": 4622 },
              "end": { "line": 73, "column": 309, "offset": 4930 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 73, "column": 1, "offset": 4622 },
          "end": { "line": 73, "column": 309, "offset": 4930 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "patterns",
            "position": {
              "start": { "line": 75, "column": 6, "offset": 4937 },
              "end": { "line": 75, "column": 14, "offset": 4945 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 75, "column": 1, "offset": 4932 },
          "end": { "line": 75, "column": 14, "offset": 4945 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "html",
            "title": null,
            "url": "./pattern.jpg",
            "alt": "access pattern",
            "position": {
              "start": { "line": 77, "column": 1, "offset": 4947 },
              "end": { "line": 77, "column": 33, "offset": 4979 },
              "indent": []
            },
            "value": "<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d3f4c1e8944826ac08d7b974ad9718b8/93f40/pattern.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.759847522236335%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABQABA//EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAFLgnsA8vB//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECMQMREhP/2gAIAQEAAQUCzuRuXn1MdCr/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFH/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAECEv/aAAgBAgEBPwGasP/EABcQAAMBAAAAAAAAAAAAAAAAAAABMSD/2gAIAQEABj8CRXSvH//EABoQAAEFAQAAAAAAAAAAAAAAAAABETFBcfD/2gAIAQEAAT8hRXTDoKG4CQojw//aAAwDAQACAAMAAAAQa/8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAFx/9oACAEDAQE/ELGn/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAgEBPxBjdpWn/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARMSFxocH/2gAIAQEAAT8QBo62LhyF6hzwuRXCr2k8DPmeFP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"access pattern\"\n        title=\"access pattern\"\n        src=\"/static/d3f4c1e8944826ac08d7b974ad9718b8/88218/pattern.jpg\"\n        srcset=\"/static/d3f4c1e8944826ac08d7b974ad9718b8/7237a/pattern.jpg 148w,\n/static/d3f4c1e8944826ac08d7b974ad9718b8/0cfdf/pattern.jpg 295w,\n/static/d3f4c1e8944826ac08d7b974ad9718b8/88218/pattern.jpg 590w,\n/static/d3f4c1e8944826ac08d7b974ad9718b8/93f40/pattern.jpg 787w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">access pattern</figcaption>\n  </figure>"
          }
        ],
        "position": {
          "start": { "line": 77, "column": 1, "offset": 4947 },
          "end": { "line": 77, "column": 33, "offset": 4979 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "M: unfavorable data access pattern",
                "position": {
                  "start": { "line": 79, "column": 8, "offset": 4988 },
                  "end": { "line": 79, "column": 42, "offset": 5022 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 79, "column": 6, "offset": 4986 },
              "end": { "line": 79, "column": 44, "offset": 5024 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 79, "column": 1, "offset": 4981 },
          "end": { "line": 79, "column": 44, "offset": 5024 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "fig.(A) above illustrates the data access pattern of the M array",
                    "position": {
                      "start": { "line": 81, "column": 3, "offset": 5028 },
                      "end": { "line": 81, "column": 67, "offset": 5092 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 81, "column": 3, "offset": 5028 },
                  "end": { "line": 81, "column": 67, "offset": 5092 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 81, "column": 1, "offset": 5026 },
              "end": { "line": 81, "column": 67, "offset": 5092 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "threads in a warp read adjacent rows",
                    "position": {
                      "start": { "line": 82, "column": 3, "offset": 5095 },
                      "end": { "line": 82, "column": 39, "offset": 5131 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 82, "column": 3, "offset": 5095 },
                  "end": { "line": 82, "column": 39, "offset": 5131 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 82, "column": 1, "offset": 5093 },
              "end": { "line": 82, "column": 39, "offset": 5131 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "during iteration 0, threads in a warp read ",
                    "position": {
                      "start": { "line": 83, "column": 3, "offset": 5134 },
                      "end": { "line": 83, "column": 46, "offset": 5177 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "element 0",
                        "position": {
                          "start": { "line": 83, "column": 48, "offset": 5179 },
                          "end": { "line": 83, "column": 57, "offset": 5188 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 83, "column": 46, "offset": 5177 },
                      "end": { "line": 83, "column": 59, "offset": 5190 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " of rows 0 through 31.",
                    "position": {
                      "start": { "line": 83, "column": 59, "offset": 5190 },
                      "end": { "line": 83, "column": 81, "offset": 5212 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 83, "column": 3, "offset": 5134 },
                  "end": { "line": 83, "column": 81, "offset": 5212 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 83, "column": 1, "offset": 5132 },
              "end": { "line": 83, "column": 81, "offset": 5212 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "during iteration 1, these same threads read ",
                    "position": {
                      "start": { "line": 84, "column": 3, "offset": 5215 },
                      "end": { "line": 84, "column": 47, "offset": 5259 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "element 1",
                        "position": {
                          "start": { "line": 84, "column": 49, "offset": 5261 },
                          "end": { "line": 84, "column": 58, "offset": 5270 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 84, "column": 47, "offset": 5259 },
                      "end": { "line": 84, "column": 60, "offset": 5272 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " of rows 0 through 31.",
                    "position": {
                      "start": { "line": 84, "column": 60, "offset": 5272 },
                      "end": { "line": 84, "column": 82, "offset": 5294 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 84, "column": 3, "offset": 5215 },
                  "end": { "line": 84, "column": 82, "offset": 5294 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 84, "column": 1, "offset": 5213 },
              "end": { "line": 84, "column": 82, "offset": 5294 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "None",
                        "position": {
                          "start": { "line": 85, "column": 5, "offset": 5299 },
                          "end": { "line": 85, "column": 9, "offset": 5303 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 85, "column": 3, "offset": 5297 },
                      "end": { "line": 85, "column": 11, "offset": 5305 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " of the accesses will be coalesced.",
                    "position": {
                      "start": { "line": 85, "column": 11, "offset": 5305 },
                      "end": { "line": 85, "column": 46, "offset": 5340 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 85, "column": 3, "offset": 5297 },
                  "end": { "line": 85, "column": 46, "offset": 5340 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 85, "column": 1, "offset": 5295 },
              "end": { "line": 85, "column": 46, "offset": 5340 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 81, "column": 1, "offset": 5026 },
          "end": { "line": 85, "column": 46, "offset": 5340 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "N: favorable data access pattern",
                "position": {
                  "start": { "line": 87, "column": 8, "offset": 5349 },
                  "end": { "line": 87, "column": 40, "offset": 5381 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 87, "column": 6, "offset": 5347 },
              "end": { "line": 87, "column": 42, "offset": 5383 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 87, "column": 1, "offset": 5342 },
          "end": { "line": 87, "column": 42, "offset": 5383 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "fig.(B) above illustrates the data access pattern of the N array",
                    "position": {
                      "start": { "line": 89, "column": 3, "offset": 5387 },
                      "end": { "line": 89, "column": 67, "offset": 5451 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 89, "column": 3, "offset": 5387 },
                  "end": { "line": 89, "column": 67, "offset": 5451 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 89, "column": 1, "offset": 5385 },
              "end": { "line": 90, "column": 1, "offset": 5452 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "each thread reads a column of N.",
                    "position": {
                      "start": { "line": 91, "column": 3, "offset": 5455 },
                      "end": { "line": 91, "column": 35, "offset": 5487 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 91, "column": 3, "offset": 5455 },
                  "end": { "line": 91, "column": 35, "offset": 5487 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 91, "column": 1, "offset": 5453 },
              "end": { "line": 92, "column": 1, "offset": 5488 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "during iteration 0, threads in warp 0 read ",
                    "position": {
                      "start": { "line": 93, "column": 3, "offset": 5491 },
                      "end": { "line": 93, "column": 46, "offset": 5534 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "element 1",
                        "position": {
                          "start": { "line": 93, "column": 48, "offset": 5536 },
                          "end": { "line": 93, "column": 57, "offset": 5545 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 93, "column": 46, "offset": 5534 },
                      "end": { "line": 93, "column": 59, "offset": 5547 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " of columns 0 through 31.",
                    "position": {
                      "start": { "line": 93, "column": 59, "offset": 5547 },
                      "end": { "line": 93, "column": 84, "offset": 5572 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 93, "column": 3, "offset": 5491 },
                  "end": { "line": 93, "column": 84, "offset": 5572 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 93, "column": 1, "offset": 5489 },
              "end": { "line": 94, "column": 1, "offset": 5573 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "all these accesses will be coalesced.",
                    "position": {
                      "start": { "line": 95, "column": 3, "offset": 5576 },
                      "end": { "line": 95, "column": 40, "offset": 5613 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 95, "column": 3, "offset": 5576 },
                  "end": { "line": 95, "column": 40, "offset": 5613 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 95, "column": 1, "offset": 5574 },
              "end": { "line": 95, "column": 40, "offset": 5613 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 89, "column": 1, "offset": 5385 },
          "end": { "line": 95, "column": 40, "offset": 5613 },
          "indent": [1, 1, 1, 1, 1, 1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "If the above doesn’t make sense to you 🧐, read the post on the matrix application kernel here: ",
            "position": {
              "start": { "line": 97, "column": 1, "offset": 5615 },
              "end": { "line": 97, "column": 97, "offset": 5711 },
              "indent": []
            }
          },
          {
            "type": "link",
            "title": null,
            "url": "/cuda7-matrixmult",
            "children": [
              {
                "type": "text",
                "value": "CUDA Programming Examples - 1. Matrix Multiplication",
                "position": {
                  "start": { "line": 97, "column": 98, "offset": 5712 },
                  "end": { "line": 97, "column": 150, "offset": 5764 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 97, "column": 97, "offset": 5711 },
              "end": { "line": 97, "column": 170, "offset": 5784 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 97, "column": 1, "offset": 5615 },
          "end": { "line": 97, "column": 170, "offset": 5784 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "a coalesced access pattern — example of N",
            "position": {
              "start": { "line": 99, "column": 6, "offset": 5791 },
              "end": { "line": 99, "column": 48, "offset": 5833 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 99, "column": 1, "offset": 5786 },
          "end": { "line": 99, "column": 48, "offset": 5833 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "html",
            "title": null,
            "url": "./coalescedP.jpg",
            "alt": "a coalesced access pattern",
            "position": {
              "start": { "line": 101, "column": 1, "offset": 5835 },
              "end": { "line": 101, "column": 48, "offset": 5882 },
              "indent": []
            },
            "value": "<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5e76a9b8f6899418b29b8cc01a01ba39/423f5/coalescedP.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.55194805194806%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFAv/EABUBAQEAAAAAAAAAAAAAAAAAAAIA/9oADAMBAAIQAxAAAAG0vhIq8RyH/8QAGxAAAgIDAQAAAAAAAAAAAAAAAgMBFAAQESH/2gAIAQEAAQUCL2ELMNNORG0ztg8//8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAB/9oACAEDAQE/ATSb/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAIR/9oACAECAQE/AVjFP//EABsQAAEFAQEAAAAAAAAAAAAAAAABERIhQQIQ/9oACAEBAAY/AlZcFn3LyhqMP//EABwQAAMAAQUAAAAAAAAAAAAAAAABESEQMWFxkf/aAAgBAQABPyHGQbhDpkI9tK+LSOaOjl8H/9oADAMBAAIAAwAAABDA7//EABYRAQEBAAAAAAAAAAAAAAAAABEAQf/aAAgBAwEBPxAFkL//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEx/9oACAECAQE/EEuhyzf/xAAaEAEAAgMBAAAAAAAAAAAAAAABESEAEDFR/9oACAEBAAE/EDbKSTA+4foQhNJ3SysBZOAQtGuf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"a coalesced access pattern\"\n        title=\"a coalesced access pattern\"\n        src=\"/static/5e76a9b8f6899418b29b8cc01a01ba39/88218/coalescedP.jpg\"\n        srcset=\"/static/5e76a9b8f6899418b29b8cc01a01ba39/7237a/coalescedP.jpg 148w,\n/static/5e76a9b8f6899418b29b8cc01a01ba39/0cfdf/coalescedP.jpg 295w,\n/static/5e76a9b8f6899418b29b8cc01a01ba39/88218/coalescedP.jpg 590w,\n/static/5e76a9b8f6899418b29b8cc01a01ba39/77d57/coalescedP.jpg 885w,\n/static/5e76a9b8f6899418b29b8cc01a01ba39/5a917/coalescedP.jpg 1180w,\n/static/5e76a9b8f6899418b29b8cc01a01ba39/423f5/coalescedP.jpg 1232w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">a coalesced access pattern</figcaption>\n  </figure>"
          }
        ],
        "position": {
          "start": { "line": 101, "column": 1, "offset": 5835 },
          "end": { "line": 101, "column": 48, "offset": 5882 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The arrow in the top portion of the figure shows the access pattern of the kernel code.",
                    "position": {
                      "start": { "line": 103, "column": 3, "offset": 5886 },
                      "end": { "line": 103, "column": 90, "offset": 5973 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 103, "column": 3, "offset": 5886 },
                  "end": { "line": 103, "column": 90, "offset": 5973 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 103, "column": 1, "offset": 5884 },
              "end": { "line": 103, "column": 90, "offset": 5973 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 103, "column": 1, "offset": 5884 },
          "end": { "line": 103, "column": 90, "offset": 5973 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Recall the for-loop in the kernel:",
            "position": {
              "start": { "line": 105, "column": 1, "offset": 5975 },
              "end": { "line": 105, "column": 35, "offset": 6009 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 105, "column": 1, "offset": 5975 },
          "end": { "line": 105, "column": 35, "offset": 6009 },
          "indent": []
        }
      },
      {
        "type": "html",
        "lang": "c",
        "meta": null,
        "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">__global__ <span class=\"token keyword\">void</span> MatrixMulKernel <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token operator\">*</span> M<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span><span class=\"token operator\">*</span> N<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span><span class=\"token operator\">*</span> P<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> Width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// calculate the row index of the P element and M</span>\n    <span class=\"token keyword\">int</span> Row <span class=\"token operator\">=</span> blockIdx<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> blockDim<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// calculate the col index of the P element and N</span>\n    <span class=\"token keyword\">int</span> Col <span class=\"token operator\">=</span> blockIdx<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> blockDim<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Row <span class=\"token operator\">&lt;</span> Width<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>Col <span class=\"token operator\">&lt;</span> Width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">float</span> Pvalue <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//each thread computes one element of the block sub-matrix</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> Width<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            Pvalue <span class=\"token operator\">+=</span> M<span class=\"token punctuation\">[</span>Row<span class=\"token operator\">*</span>Width <span class=\"token operator\">+</span> k<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> N<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span>Width <span class=\"token operator\">+</span> Col<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        P<span class=\"token punctuation\">[</span>Row <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> Col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Pvalue<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>",
        "position": {
          "start": { "line": 107, "column": 1, "offset": 6011 },
          "end": { "line": 123, "column": 4, "offset": 6599 },
          "indent": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Within a given iteration of the ",
                    "position": {
                      "start": { "line": 125, "column": 3, "offset": 6603 },
                      "end": { "line": 125, "column": 35, "offset": 6635 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">k</code>",
                    "position": {
                      "start": { "line": 125, "column": 35, "offset": 6635 },
                      "end": { "line": 125, "column": 38, "offset": 6638 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " loop, the ",
                    "position": {
                      "start": { "line": 125, "column": 38, "offset": 6638 },
                      "end": { "line": 125, "column": 49, "offset": 6649 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">k*Width</code>",
                    "position": {
                      "start": { "line": 125, "column": 49, "offset": 6649 },
                      "end": { "line": 125, "column": 58, "offset": 6658 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " value is the same across all threads. Recall that ",
                    "position": {
                      "start": { "line": 125, "column": 58, "offset": 6658 },
                      "end": { "line": 125, "column": 109, "offset": 6709 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">Col=blockIdx.x*blockDim.x+threadIdx.x</code>",
                    "position": {
                      "start": { "line": 125, "column": 109, "offset": 6709 },
                      "end": { "line": 125, "column": 148, "offset": 6748 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ".",
                    "position": {
                      "start": { "line": 125, "column": 148, "offset": 6748 },
                      "end": { "line": 125, "column": 149, "offset": 6749 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 125, "column": 3, "offset": 6603 },
                  "end": { "line": 125, "column": 149, "offset": 6749 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 125, "column": 1, "offset": 6601 },
              "end": { "line": 126, "column": 1, "offset": 6750 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Since the value of blockIndx.x and blockDim.x are of the same value for all threads in the same block, the only part of ",
                    "position": {
                      "start": { "line": 127, "column": 3, "offset": 6753 },
                      "end": { "line": 127, "column": 123, "offset": 6873 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">k*Width+Col</code>",
                    "position": {
                      "start": { "line": 127, "column": 123, "offset": 6873 },
                      "end": { "line": 127, "column": 136, "offset": 6886 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " that varies across a thread block is threadIdx.x.",
                    "position": {
                      "start": { "line": 127, "column": 136, "offset": 6886 },
                      "end": { "line": 127, "column": 186, "offset": 6936 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 127, "column": 3, "offset": 6753 },
                  "end": { "line": 127, "column": 186, "offset": 6936 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 127, "column": 1, "offset": 6751 },
              "end": { "line": 128, "column": 1, "offset": 6937 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Since ",
                    "position": {
                      "start": { "line": 129, "column": 3, "offset": 6940 },
                      "end": { "line": 129, "column": 9, "offset": 6946 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "adjacent threads",
                        "position": {
                          "start": {
                            "line": 129,
                            "column": 11,
                            "offset": 6948
                          },
                          "end": { "line": 129, "column": 27, "offset": 6964 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 129, "column": 9, "offset": 6946 },
                      "end": { "line": 129, "column": 29, "offset": 6966 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " have consecutive threadIdx.x values, their accessed elements will have consecutive addresses.",
                    "position": {
                      "start": { "line": 129, "column": 29, "offset": 6966 },
                      "end": { "line": 129, "column": 123, "offset": 7060 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 129, "column": 3, "offset": 6940 },
                  "end": { "line": 129, "column": 123, "offset": 7060 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 129, "column": 1, "offset": 6938 },
              "end": { "line": 129, "column": 123, "offset": 7060 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 125, "column": 1, "offset": 6601 },
          "end": { "line": 129, "column": 123, "offset": 7060 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In the pictured example, we are using only 1 block to calculate the entire P matrix, where:",
            "position": {
              "start": { "line": 131, "column": 1, "offset": 7062 },
              "end": { "line": 131, "column": 92, "offset": 7153 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 131, "column": 1, "offset": 7062 },
          "end": { "line": 131, "column": 92, "offset": 7153 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "block size: 4 ",
                    "position": {
                      "start": { "line": 133, "column": 3, "offset": 7157 },
                      "end": { "line": 133, "column": 17, "offset": 7171 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 133, "column": 17, "offset": 7171 },
                      "end": { "line": 133, "column": 19, "offset": 7173 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " 4",
                    "position": {
                      "start": { "line": 133, "column": 19, "offset": 7173 },
                      "end": { "line": 133, "column": 21, "offset": 7175 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 133, "column": 3, "offset": 7157 },
                  "end": { "line": 133, "column": 21, "offset": 7175 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 133, "column": 1, "offset": 7155 },
              "end": { "line": 133, "column": 21, "offset": 7175 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "warp size: 4",
                    "position": {
                      "start": { "line": 134, "column": 3, "offset": 7178 },
                      "end": { "line": 134, "column": 15, "offset": 7190 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 134, "column": 3, "offset": 7178 },
                  "end": { "line": 134, "column": 15, "offset": 7190 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 134, "column": 1, "offset": 7176 },
              "end": { "line": 134, "column": 15, "offset": 7190 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">Width = 4</code>",
                    "position": {
                      "start": { "line": 135, "column": 3, "offset": 7193 },
                      "end": { "line": 135, "column": 14, "offset": 7204 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 135, "column": 3, "offset": 7193 },
                  "end": { "line": 135, "column": 14, "offset": 7204 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 135, "column": 1, "offset": 7191 },
              "end": { "line": 135, "column": 14, "offset": 7204 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">blockDim.x = 4</code>",
                    "position": {
                      "start": { "line": 136, "column": 3, "offset": 7207 },
                      "end": { "line": 136, "column": 19, "offset": 7223 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 136, "column": 3, "offset": 7207 },
                  "end": { "line": 136, "column": 19, "offset": 7223 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 136, "column": 1, "offset": 7205 },
              "end": { "line": 136, "column": 19, "offset": 7223 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">blockIdx.x = 0</code>",
                    "position": {
                      "start": { "line": 137, "column": 3, "offset": 7226 },
                      "end": { "line": 137, "column": 19, "offset": 7242 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 137, "column": 3, "offset": 7226 },
                  "end": { "line": 137, "column": 19, "offset": 7242 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 137, "column": 1, "offset": 7224 },
              "end": { "line": 138, "column": 1, "offset": 7243 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "In ",
                    "position": {
                      "start": { "line": 139, "column": 3, "offset": 7246 },
                      "end": { "line": 139, "column": 6, "offset": 7249 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">iteration 0</code>",
                    "position": {
                      "start": { "line": 139, "column": 6, "offset": 7249 },
                      "end": { "line": 139, "column": 19, "offset": 7262 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ", the k value is 0. The index used by each thread for accessing N is",
                    "position": {
                      "start": { "line": 139, "column": 19, "offset": 7262 },
                      "end": { "line": 139, "column": 87, "offset": 7330 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 139, "column": 3, "offset": 7246 },
                  "end": { "line": 139, "column": 87, "offset": 7330 },
                  "indent": []
                }
              },
              {
                "type": "html",
                "lang": "c",
                "meta": null,
                "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">N<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> Col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> N <span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> blockIdx<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> blockDim<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span>\n                 <span class=\"token operator\">=</span>N<span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> threadidx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span>\n                 <span class=\"token operator\">=</span>N<span class=\"token punctuation\">[</span>threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span></code></pre></div>",
                "position": {
                  "start": { "line": 141, "column": 3, "offset": 7334 },
                  "end": { "line": 145, "column": 6, "offset": 7511 },
                  "indent": [3, 5, 5, 3]
                }
              },
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "That is, within this thread ",
                    "position": {
                      "start": { "line": 147, "column": 3, "offset": 7515 },
                      "end": { "line": 147, "column": 31, "offset": 7543 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "block",
                        "position": {
                          "start": {
                            "line": 147,
                            "column": 33,
                            "offset": 7545
                          },
                          "end": { "line": 147, "column": 38, "offset": 7550 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 147, "column": 31, "offset": 7543 },
                      "end": { "line": 147, "column": 40, "offset": 7552 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ", the index for accessing N is simply the value of threadIdx.x. The N elements accessed by ",
                    "position": {
                      "start": { "line": 147, "column": 40, "offset": 7552 },
                      "end": { "line": 147, "column": 131, "offset": 7643 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">T0, T1, T2, T3</code>",
                    "position": {
                      "start": { "line": 147, "column": 131, "offset": 7643 },
                      "end": { "line": 147, "column": 147, "offset": 7659 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " are ",
                    "position": {
                      "start": { "line": 147, "column": 147, "offset": 7659 },
                      "end": { "line": 147, "column": 152, "offset": 7664 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">N[0], N[1], N[2], and N[3]</code>",
                    "position": {
                      "start": { "line": 147, "column": 152, "offset": 7664 },
                      "end": { "line": 147, "column": 180, "offset": 7692 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ". This is illustrated with the ",
                    "position": {
                      "start": { "line": 147, "column": 180, "offset": 7692 },
                      "end": { "line": 147, "column": 211, "offset": 7723 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">“Load iteration 0”</code>",
                    "position": {
                      "start": { "line": 147, "column": 211, "offset": 7723 },
                      "end": { "line": 147, "column": 231, "offset": 7743 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " box of the above figure.",
                    "position": {
                      "start": { "line": 147, "column": 231, "offset": 7743 },
                      "end": { "line": 147, "column": 256, "offset": 7768 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 147, "column": 3, "offset": 7515 },
                  "end": { "line": 147, "column": 256, "offset": 7768 },
                  "indent": []
                }
              },
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "These elements are in consecutive locations in the global memory. The hardware detects that ",
                    "position": {
                      "start": { "line": 149, "column": 3, "offset": 7772 },
                      "end": { "line": 149, "column": 95, "offset": 7864 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "these accesses are made by threads in a warp and to consecutive locations in the global memory",
                        "position": {
                          "start": {
                            "line": 149,
                            "column": 97,
                            "offset": 7866
                          },
                          "end": { "line": 149, "column": 191, "offset": 7960 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 149, "column": 95, "offset": 7864 },
                      "end": { "line": 149, "column": 193, "offset": 7962 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ". It coalesces these accesses into a consolidated access. This allows the DRAMs to supply data at a high rate.",
                    "position": {
                      "start": { "line": 149, "column": 193, "offset": 7962 },
                      "end": { "line": 149, "column": 303, "offset": 8072 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 149, "column": 3, "offset": 7772 },
                  "end": { "line": 149, "column": 303, "offset": 8072 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 139, "column": 1, "offset": 7244 },
              "end": { "line": 150, "column": 1, "offset": 8073 },
              "indent": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "In ",
                    "position": {
                      "start": { "line": 151, "column": 3, "offset": 8076 },
                      "end": { "line": 151, "column": 6, "offset": 8079 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">iteration 1</code>",
                    "position": {
                      "start": { "line": 151, "column": 6, "offset": 8079 },
                      "end": { "line": 151, "column": 19, "offset": 8092 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ", similarly:",
                    "position": {
                      "start": { "line": 151, "column": 19, "offset": 8092 },
                      "end": { "line": 151, "column": 31, "offset": 8104 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 151, "column": 3, "offset": 8076 },
                  "end": { "line": 151, "column": 31, "offset": 8104 },
                  "indent": []
                }
              },
              {
                "type": "html",
                "lang": "c",
                "meta": null,
                "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">N<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> Col<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> N<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> blockIdx<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> blockDim<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span>\n                 <span class=\"token operator\">=</span> N<span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> threadidx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span>\n                 <span class=\"token operator\">=</span> N<span class=\"token punctuation\">[</span><span class=\"token number\">4</span> <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">]</span></code></pre></div>",
                "position": {
                  "start": { "line": 152, "column": 3, "offset": 8107 },
                  "end": { "line": 156, "column": 6, "offset": 8289 },
                  "indent": [3, 5, 5, 3]
                }
              },
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The N elements accessed by ",
                    "position": {
                      "start": { "line": 157, "column": 3, "offset": 8292 },
                      "end": { "line": 157, "column": 30, "offset": 8319 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">T0, T1, T2, T3</code>",
                    "position": {
                      "start": { "line": 157, "column": 30, "offset": 8319 },
                      "end": { "line": 157, "column": 46, "offset": 8335 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " in this iteration are ",
                    "position": {
                      "start": { "line": 157, "column": 46, "offset": 8335 },
                      "end": { "line": 157, "column": 69, "offset": 8358 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">N[5], N[6], N[7], and N[8]</code>",
                    "position": {
                      "start": { "line": 157, "column": 69, "offset": 8358 },
                      "end": { "line": 157, "column": 97, "offset": 8386 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ", as shown with the “Load iteration 1” box.",
                    "position": {
                      "start": { "line": 157, "column": 97, "offset": 8386 },
                      "end": { "line": 157, "column": 140, "offset": 8429 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 157, "column": 3, "offset": 8292 },
                  "end": { "line": 157, "column": 140, "offset": 8429 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 151, "column": 1, "offset": 8074 },
              "end": { "line": 157, "column": 140, "offset": 8429 },
              "indent": [1, 1, 1, 1, 1, 1]
            }
          }
        ],
        "position": {
          "start": { "line": 133, "column": 1, "offset": 7155 },
          "end": { "line": 157, "column": 140, "offset": 8429 },
          "indent": [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
          ]
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "an un-coalesced access pattern — example of M",
            "position": {
              "start": { "line": 159, "column": 6, "offset": 8436 },
              "end": { "line": 159, "column": 52, "offset": 8482 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 159, "column": 1, "offset": 8431 },
          "end": { "line": 159, "column": 52, "offset": 8482 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "html",
            "title": null,
            "url": "./uncoalescedP.jpg",
            "alt": "an un-coalesced access pattern",
            "position": {
              "start": { "line": 161, "column": 1, "offset": 8484 },
              "end": { "line": 161, "column": 54, "offset": 8537 },
              "indent": []
            },
            "value": "<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7670edec83ba2cfd4fe413f0e10b2e42/a0f91/uncoalescedP.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.91056910569105%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHehcuW0lGf/8QAGhAAAgIDAAAAAAAAAAAAAAAAAgMAARETFP/aAAgBAQABBQKIMyOEwarpVneuf//EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8B1cP/xAAYEQACAwAAAAAAAAAAAAAAAAAAEQECMf/aAAgBAgEBPwGFbBn/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIREDEy/9oACAEBAAY/AhqUKxbZ0bP/xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhEDFRkaH/2gAIAQEAAT8hUqOANbumBrPEQrbphRnyz//aAAwDAQACAAMAAAAQqy//xAAYEQADAQEAAAAAAAAAAAAAAAAAAREhYf/aAAgBAwEBPxCIrMOx/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAgEBPxBmVqRp/8QAFxABAQEBAAAAAAAAAAAAAAAAAREAIf/aAAgBAQABPxAiFOmBl2gQWmpkCaiCcoVpA0cUuv/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"an un-coalesced access pattern\"\n        title=\"an un-coalesced access pattern\"\n        src=\"/static/7670edec83ba2cfd4fe413f0e10b2e42/88218/uncoalescedP.jpg\"\n        srcset=\"/static/7670edec83ba2cfd4fe413f0e10b2e42/7237a/uncoalescedP.jpg 148w,\n/static/7670edec83ba2cfd4fe413f0e10b2e42/0cfdf/uncoalescedP.jpg 295w,\n/static/7670edec83ba2cfd4fe413f0e10b2e42/88218/uncoalescedP.jpg 590w,\n/static/7670edec83ba2cfd4fe413f0e10b2e42/77d57/uncoalescedP.jpg 885w,\n/static/7670edec83ba2cfd4fe413f0e10b2e42/5a917/uncoalescedP.jpg 1180w,\n/static/7670edec83ba2cfd4fe413f0e10b2e42/a0f91/uncoalescedP.jpg 1230w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">an un-coalesced access pattern</figcaption>\n  </figure>"
          }
        ],
        "position": {
          "start": { "line": 161, "column": 1, "offset": 8484 },
          "end": { "line": 161, "column": 54, "offset": 8537 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The arrow in the top portion of the figure shows that the kernel code for ",
                    "position": {
                      "start": { "line": 163, "column": 3, "offset": 8541 },
                      "end": { "line": 163, "column": 77, "offset": 8615 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "each thread",
                        "position": {
                          "start": {
                            "line": 163,
                            "column": 79,
                            "offset": 8617
                          },
                          "end": { "line": 163, "column": 90, "offset": 8628 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 163, "column": 77, "offset": 8615 },
                      "end": { "line": 163, "column": 92, "offset": 8630 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " accesses elements of a row in sequence",
                    "position": {
                      "start": { "line": 163, "column": 92, "offset": 8630 },
                      "end": { "line": 163, "column": 131, "offset": 8669 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 163, "column": 3, "offset": 8541 },
                  "end": { "line": 163, "column": 131, "offset": 8669 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 163, "column": 1, "offset": 8539 },
              "end": { "line": 164, "column": 1, "offset": 8670 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "block size: 4 ",
                    "position": {
                      "start": { "line": 165, "column": 3, "offset": 8673 },
                      "end": { "line": 165, "column": 17, "offset": 8687 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 165, "column": 17, "offset": 8687 },
                      "end": { "line": 165, "column": 19, "offset": 8689 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " 4",
                    "position": {
                      "start": { "line": 165, "column": 19, "offset": 8689 },
                      "end": { "line": 165, "column": 21, "offset": 8691 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 165, "column": 3, "offset": 8673 },
                  "end": { "line": 165, "column": 21, "offset": 8691 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 165, "column": 1, "offset": 8671 },
              "end": { "line": 165, "column": 21, "offset": 8691 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "warp size: 4",
                    "position": {
                      "start": { "line": 166, "column": 3, "offset": 8694 },
                      "end": { "line": 166, "column": 15, "offset": 8706 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 166, "column": 3, "offset": 8694 },
                  "end": { "line": 166, "column": 15, "offset": 8706 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 166, "column": 1, "offset": 8692 },
              "end": { "line": 166, "column": 15, "offset": 8706 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">Width = 4</code>",
                    "position": {
                      "start": { "line": 167, "column": 3, "offset": 8709 },
                      "end": { "line": 167, "column": 14, "offset": 8720 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 167, "column": 3, "offset": 8709 },
                  "end": { "line": 167, "column": 14, "offset": 8720 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 167, "column": 1, "offset": 8707 },
              "end": { "line": 167, "column": 14, "offset": 8720 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">blockDim.y = 4</code>",
                    "position": {
                      "start": { "line": 168, "column": 3, "offset": 8723 },
                      "end": { "line": 168, "column": 19, "offset": 8739 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 168, "column": 3, "offset": 8723 },
                  "end": { "line": 168, "column": 19, "offset": 8739 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 168, "column": 1, "offset": 8721 },
              "end": { "line": 168, "column": 19, "offset": 8739 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">blockIdx.y = 0</code>",
                    "position": {
                      "start": { "line": 169, "column": 3, "offset": 8742 },
                      "end": { "line": 169, "column": 19, "offset": 8758 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 169, "column": 3, "offset": 8742 },
                  "end": { "line": 169, "column": 19, "offset": 8758 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 169, "column": 1, "offset": 8740 },
              "end": { "line": 169, "column": 19, "offset": 8758 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The index used by each thread for accessing M is:",
                    "position": {
                      "start": { "line": 170, "column": 3, "offset": 8761 },
                      "end": { "line": 170, "column": 52, "offset": 8810 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 170, "column": 3, "offset": 8761 },
                  "end": { "line": 170, "column": 52, "offset": 8810 },
                  "indent": []
                }
              },
              {
                "type": "html",
                "lang": "c",
                "meta": null,
                "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">M<span class=\"token punctuation\">[</span>Row <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> k<span class=\"token punctuation\">]</span>  <span class=\"token operator\">=</span>M<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>blockIdx<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> blockDim<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> Width <span class=\"token operator\">+</span> k<span class=\"token punctuation\">]</span>\n\n                  <span class=\"token operator\">=</span>M<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span><span class=\"token operator\">+</span>  threadIdx<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n                  <span class=\"token operator\">=</span>M<span class=\"token punctuation\">[</span>threadIdx<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span></code></pre></div>",
                "position": {
                  "start": { "line": 172, "column": 3, "offset": 8814 },
                  "end": { "line": 178, "column": 6, "offset": 9003 },
                  "indent": [3, 1, 5, 1, 5, 3]
                }
              }
            ],
            "position": {
              "start": { "line": 170, "column": 1, "offset": 8759 },
              "end": { "line": 179, "column": 1, "offset": 9004 },
              "indent": [1, 1, 1, 1, 1, 1, 1, 1, 1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "The M elements accessed by ",
                    "position": {
                      "start": { "line": 180, "column": 3, "offset": 9007 },
                      "end": { "line": 180, "column": 30, "offset": 9034 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">T0, T1, T2, T3</code>",
                    "position": {
                      "start": { "line": 180, "column": 30, "offset": 9034 },
                      "end": { "line": 180, "column": 46, "offset": 9050 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " are ",
                    "position": {
                      "start": { "line": 180, "column": 46, "offset": 9050 },
                      "end": { "line": 180, "column": 51, "offset": 9055 },
                      "indent": []
                    }
                  },
                  {
                    "type": "html",
                    "value": "<code class=\"language-text\">M[0], M[4], M[8], and M[12]</code>",
                    "position": {
                      "start": { "line": 180, "column": 51, "offset": 9055 },
                      "end": { "line": 180, "column": 80, "offset": 9084 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ", as shown with the “Load iteration 0” box in the above figure. These elements are not in consecutive locations in the global memory. The hardware cannot coalesce these accesses into a consolidated access.",
                    "position": {
                      "start": { "line": 180, "column": 80, "offset": 9084 },
                      "end": { "line": 180, "column": 285, "offset": 9289 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 180, "column": 3, "offset": 9007 },
                  "end": { "line": 180, "column": 285, "offset": 9289 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 180, "column": 1, "offset": 9005 },
              "end": { "line": 180, "column": 285, "offset": 9289 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 163, "column": 1, "offset": 8539 },
          "end": { "line": 180, "column": 285, "offset": 9289 },
          "indent": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "note on alignment",
            "position": {
              "start": { "line": 182, "column": 5, "offset": 9295 },
              "end": { "line": 182, "column": 22, "offset": 9312 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 182, "column": 1, "offset": 9291 },
          "end": { "line": 182, "column": 22, "offset": 9312 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "When accessing words of size 1, 2, 4, 8, or 16 bytes and are aligned, compiler translates this to 1 global memory instruction.",
            "position": {
              "start": { "line": 184, "column": 1, "offset": 9314 },
              "end": { "line": 184, "column": 127, "offset": 9440 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 184, "column": 1, "offset": 9314 },
          "end": { "line": 184, "column": 127, "offset": 9440 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "But if size and alignment requirements are not met, compiler would translate it to multiple global memory access instructions.",
            "position": {
              "start": { "line": 186, "column": 1, "offset": 9442 },
              "end": { "line": 186, "column": 127, "offset": 9568 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 186, "column": 1, "offset": 9442 },
          "end": { "line": 186, "column": 127, "offset": 9568 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You can enforce the compiler to align using ",
            "position": {
              "start": { "line": 188, "column": 1, "offset": 9570 },
              "end": { "line": 188, "column": 45, "offset": 9614 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">__align(x)__</code>",
            "position": {
              "start": { "line": 188, "column": 45, "offset": 9614 },
              "end": { "line": 188, "column": 59, "offset": 9628 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", for example: ",
            "position": {
              "start": { "line": 188, "column": 59, "offset": 9628 },
              "end": { "line": 188, "column": 74, "offset": 9643 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">struct __align(16)__{...};</code>",
            "position": {
              "start": { "line": 188, "column": 74, "offset": 9643 },
              "end": { "line": 188, "column": 102, "offset": 9671 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 188, "column": 1, "offset": 9570 },
          "end": { "line": 188, "column": 102, "offset": 9671 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Corner Turning",
            "position": {
              "start": { "line": 190, "column": 4, "offset": 9676 },
              "end": { "line": 190, "column": 18, "offset": 9690 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 190, "column": 1, "offset": 9673 },
          "end": { "line": 190, "column": 18, "offset": 9690 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "What if we have to iterate through data along the row direction?",
            "position": {
              "start": { "line": 192, "column": 1, "offset": 9692 },
              "end": { "line": 192, "column": 65, "offset": 9756 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 192, "column": 1, "offset": 9692 },
          "end": { "line": 192, "column": 65, "offset": 9756 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "We can use the shared memory to enable memory coalescing — this is the technique called corner turning",
                    "position": {
                      "start": { "line": 194, "column": 3, "offset": 9760 },
                      "end": { "line": 194, "column": 106, "offset": 9863 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 194, "column": 3, "offset": 9760 },
                  "end": { "line": 194, "column": 106, "offset": 9863 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 194, "column": 1, "offset": 9758 },
              "end": { "line": 194, "column": 106, "offset": 9863 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 194, "column": 1, "offset": 9758 },
          "end": { "line": 194, "column": 106, "offset": 9863 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "how?",
            "position": {
              "start": { "line": 196, "column": 5, "offset": 9869 },
              "end": { "line": 196, "column": 9, "offset": 9873 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 196, "column": 1, "offset": 9865 },
          "end": { "line": 196, "column": 9, "offset": 9873 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "spread": true,
        "children": [
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Use a tiled algorithm",
                    "position": {
                      "start": { "line": 198, "column": 3, "offset": 9877 },
                      "end": { "line": 198, "column": 24, "offset": 9898 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 198, "column": 3, "offset": 9877 },
                  "end": { "line": 198, "column": 24, "offset": 9898 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 198, "column": 1, "offset": 9875 },
              "end": { "line": 198, "column": 24, "offset": 9898 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Threads of a block can first cooperatively load the tiles into the shared memory",
                    "position": {
                      "start": { "line": 199, "column": 3, "offset": 9901 },
                      "end": { "line": 199, "column": 83, "offset": 9981 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 199, "column": 3, "offset": 9901 },
                  "end": { "line": 199, "column": 83, "offset": 9981 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 199, "column": 1, "offset": 9899 },
              "end": { "line": 199, "column": 83, "offset": 9981 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Care must be taken to ensure that these tiles are loaded in a coalesced pattern",
                    "position": {
                      "start": { "line": 200, "column": 3, "offset": 9984 },
                      "end": { "line": 200, "column": 82, "offset": 10063 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 200, "column": 3, "offset": 9984 },
                  "end": { "line": 200, "column": 82, "offset": 10063 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 200, "column": 1, "offset": 9982 },
              "end": { "line": 200, "column": 82, "offset": 10063 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Once the data is in shared memory, they can be accessed either on a row basis or a column basis with much less performance variation because the shared memories are implemented as intrinsically high-speed on-chip memory that does not require coalescing to achieve high data access rate.",
                    "position": {
                      "start": { "line": 201, "column": 3, "offset": 10066 },
                      "end": { "line": 201, "column": 289, "offset": 10352 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 201, "column": 3, "offset": 10066 },
                  "end": { "line": 201, "column": 289, "offset": 10352 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 201, "column": 1, "offset": 10064 },
              "end": { "line": 202, "column": 1, "offset": 10353 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "spread": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "A tiled matrix multiplication kernel is shown below:\n",
                    "position": {
                      "start": { "line": 203, "column": 3, "offset": 10356 },
                      "end": { "line": 204, "column": 3, "offset": 10411 },
                      "indent": [3]
                    }
                  },
                  {
                    "type": "html",
                    "title": null,
                    "url": "./tiled.jpg",
                    "alt": "tiled matrix multiplication kernel",
                    "position": {
                      "start": { "line": 204, "column": 3, "offset": 10411 },
                      "end": { "line": 204, "column": 53, "offset": 10461 },
                      "indent": []
                    },
                    "value": "<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/01f05364f804fa8088510ebf2c481713/2d3f1/tiled.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.98232695139912%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3URqP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAIDAAAAAAAAAAAAAAAAAAAQARFB/9oACAEBAAE/ISFpS//aAAwDAQACAAMAAAAQs8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABABEhMVH/2gAIAQEAAT8QfYd7YfCTV2KGX//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tiled matrix multiplication kernel\"\n        title=\"tiled matrix multiplication kernel\"\n        src=\"/static/01f05364f804fa8088510ebf2c481713/88218/tiled.jpg\"\n        srcset=\"/static/01f05364f804fa8088510ebf2c481713/7237a/tiled.jpg 148w,\n/static/01f05364f804fa8088510ebf2c481713/0cfdf/tiled.jpg 295w,\n/static/01f05364f804fa8088510ebf2c481713/88218/tiled.jpg 590w,\n/static/01f05364f804fa8088510ebf2c481713/77d57/tiled.jpg 885w,\n/static/01f05364f804fa8088510ebf2c481713/5a917/tiled.jpg 1180w,\n/static/01f05364f804fa8088510ebf2c481713/2d3f1/tiled.jpg 1358w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">tiled matrix multiplication kernel</figcaption>\n  </figure>"
                  }
                ],
                "position": {
                  "start": { "line": 203, "column": 3, "offset": 10356 },
                  "end": { "line": 204, "column": 53, "offset": 10461 },
                  "indent": [3]
                }
              }
            ],
            "position": {
              "start": { "line": 203, "column": 1, "offset": 10354 },
              "end": { "line": 204, "column": 53, "offset": 10461 },
              "indent": [1]
            }
          }
        ],
        "position": {
          "start": { "line": 198, "column": 1, "offset": 9875 },
          "end": { "line": 204, "column": 53, "offset": 10461 },
          "indent": [1, 1, 1, 1, 1, 1]
        }
      }
    ],
    "position": {
      "start": { "line": 1, "column": 1, "offset": 0 },
      "end": { "line": 205, "column": 1, "offset": 10462 }
    }
  }
}
