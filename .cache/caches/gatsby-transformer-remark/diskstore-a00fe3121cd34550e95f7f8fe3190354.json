{
  "expireTime": 9007200830512806000,
  "key": "transformer-remark-markdown-ast-18fa344b97fed7c7be6bba45dccf3470-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-reading-time-",
  "val": {
    "type": "root",
    "children": [
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "This is the third post in a series about what I learnt in my GPU class at NYU this past fall. Here I dive a bit deeper than the previous post into thread divergence.",
            "position": {
              "start": { "line": 2, "column": 1, "offset": 1 },
              "end": { "line": 2, "column": 166, "offset": 166 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 2, "column": 1, "offset": 1 },
          "end": { "line": 2, "column": 166, "offset": 166 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Using Control Construct with Thread Divergence",
            "position": {
              "start": { "line": 4, "column": 4, "offset": 171 },
              "end": { "line": 4, "column": 50, "offset": 217 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 4, "column": 1, "offset": 168 },
          "end": { "line": 4, "column": 50, "offset": 217 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "A prevalent reason for using a control construct with thread divergence is ",
            "position": {
              "start": { "line": 6, "column": 1, "offset": 219 },
              "end": { "line": 6, "column": 76, "offset": 294 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "handling boundary conditions",
                "position": {
                  "start": { "line": 6, "column": 78, "offset": 296 },
                  "end": { "line": 6, "column": 106, "offset": 324 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 6, "column": 76, "offset": 294 },
              "end": { "line": 6, "column": 108, "offset": 326 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " when mapping threads to data.",
            "position": {
              "start": { "line": 6, "column": 108, "offset": 326 },
              "end": { "line": 6, "column": 138, "offset": 356 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 6, "column": 1, "offset": 219 },
          "end": { "line": 6, "column": 138, "offset": 356 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "This is usually because the ",
                    "position": {
                      "start": { "line": 8, "column": 3, "offset": 360 },
                      "end": { "line": 8, "column": 31, "offset": 388 },
                      "indent": []
                    }
                  },
                  {
                    "type": "emphasis",
                    "children": [
                      {
                        "type": "text",
                        "value": "total number of threads",
                        "position": {
                          "start": { "line": 8, "column": 32, "offset": 389 },
                          "end": { "line": 8, "column": 55, "offset": 412 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 8, "column": 31, "offset": 388 },
                      "end": { "line": 8, "column": 56, "offset": 413 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " needs to be a ",
                    "position": {
                      "start": { "line": 8, "column": 56, "offset": 413 },
                      "end": { "line": 8, "column": 71, "offset": 428 },
                      "indent": []
                    }
                  },
                  {
                    "type": "emphasis",
                    "children": [
                      {
                        "type": "text",
                        "value": "multiple of the block size",
                        "position": {
                          "start": { "line": 8, "column": 72, "offset": 429 },
                          "end": { "line": 8, "column": 98, "offset": 455 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 8, "column": 71, "offset": 428 },
                      "end": { "line": 8, "column": 99, "offset": 456 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " whereas the size of the data can be an arbitrary number.",
                    "position": {
                      "start": { "line": 8, "column": 99, "offset": 456 },
                      "end": { "line": 8, "column": 156, "offset": 513 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 8, "column": 3, "offset": 360 },
                  "end": { "line": 8, "column": 156, "offset": 513 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 8, "column": 1, "offset": 358 },
              "end": { "line": 8, "column": 156, "offset": 513 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 8, "column": 1, "offset": 358 },
          "end": { "line": 8, "column": 156, "offset": 513 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "example of a vector addition kernel",
            "position": {
              "start": { "line": 10, "column": 6, "offset": 520 },
              "end": { "line": 10, "column": 41, "offset": 555 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 10, "column": 1, "offset": 515 },
          "end": { "line": 10, "column": 41, "offset": 555 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In the vector addition kernel below, there’s an if ",
            "position": {
              "start": { "line": 12, "column": 1, "offset": 557 },
              "end": { "line": 12, "column": 52, "offset": 608 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">(i&lt;n)</code>",
            "position": {
              "start": { "line": 12, "column": 52, "offset": 608 },
              "end": { "line": 12, "column": 59, "offset": 615 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " statement in addVecKernel.\nThis is because not all vector lengths can be expressed as multiples of the block size.",
            "position": {
              "start": { "line": 12, "column": 59, "offset": 615 },
              "end": { "line": 13, "column": 88, "offset": 730 },
              "indent": [1]
            }
          }
        ],
        "position": {
          "start": { "line": 12, "column": 1, "offset": 557 },
          "end": { "line": 13, "column": 88, "offset": 730 },
          "indent": [1]
        }
      },
      {
        "type": "html",
        "lang": "c",
        "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// Compute vector sum C = A+B</span>\n<span class=\"token comment\">// Each thread performs one element-wise addition</span>\n__global__ <span class=\"token function\">vecAddKernel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> blockDim<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> blockIdx<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> threadIdx<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">)</span> C<span class=\"token punctuation\">[</span>I<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span>I<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>",
        "position": {
          "start": { "line": 15, "column": 1, "offset": 732 },
          "end": { "line": 22, "column": 4, "offset": 936 },
          "indent": [1, 1, 1, 1, 1, 1, 1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "For example, assume that:",
            "position": {
              "start": { "line": 24, "column": 1, "offset": 938 },
              "end": { "line": 24, "column": 26, "offset": 963 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 24, "column": 1, "offset": 938 },
          "end": { "line": 24, "column": 26, "offset": 963 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "vector length is 1003",
                    "position": {
                      "start": { "line": 26, "column": 3, "offset": 967 },
                      "end": { "line": 26, "column": 24, "offset": 988 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 26, "column": 3, "offset": 967 },
                  "end": { "line": 26, "column": 24, "offset": 988 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 26, "column": 1, "offset": 965 },
              "end": { "line": 26, "column": 24, "offset": 988 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "block size is 64",
                    "position": {
                      "start": { "line": 27, "column": 3, "offset": 991 },
                      "end": { "line": 27, "column": 19, "offset": 1007 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 27, "column": 3, "offset": 991 },
                  "end": { "line": 27, "column": 19, "offset": 1007 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 27, "column": 1, "offset": 989 },
              "end": { "line": 27, "column": 19, "offset": 1007 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 26, "column": 1, "offset": 965 },
          "end": { "line": 27, "column": 19, "offset": 1007 },
          "indent": [1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "To process all the 1003 vector elements:",
            "position": {
              "start": { "line": 29, "column": 1, "offset": 1009 },
              "end": { "line": 29, "column": 41, "offset": 1049 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 29, "column": 1, "offset": 1009 },
          "end": { "line": 29, "column": 41, "offset": 1049 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "16 thread blocks are launched",
                    "position": {
                      "start": { "line": 31, "column": 3, "offset": 1053 },
                      "end": { "line": 31, "column": 32, "offset": 1082 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 31, "column": 3, "offset": 1053 },
                  "end": { "line": 31, "column": 32, "offset": 1082 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 31, "column": 1, "offset": 1051 },
              "end": { "line": 31, "column": 32, "offset": 1082 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "the total number of threads in these blocks would be 1024 threads",
                    "position": {
                      "start": { "line": 32, "column": 3, "offset": 1085 },
                      "end": { "line": 32, "column": 68, "offset": 1150 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 32, "column": 3, "offset": 1085 },
                  "end": { "line": 32, "column": 68, "offset": 1150 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 32, "column": 1, "offset": 1083 },
              "end": { "line": 32, "column": 68, "offset": 1150 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "the last 21 threads in thread block 15 need to be disabled",
                    "position": {
                      "start": { "line": 33, "column": 3, "offset": 1153 },
                      "end": { "line": 33, "column": 61, "offset": 1211 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 33, "column": 3, "offset": 1153 },
                  "end": { "line": 33, "column": 61, "offset": 1211 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 33, "column": 1, "offset": 1151 },
              "end": { "line": 33, "column": 61, "offset": 1211 },
              "indent": []
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "these 16 blocks are partitioned into 32 warps, ",
                    "position": {
                      "start": { "line": 34, "column": 3, "offset": 1214 },
                      "end": { "line": 34, "column": 50, "offset": 1261 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "only the last warp will have control divergence",
                        "position": {
                          "start": { "line": 34, "column": 52, "offset": 1263 },
                          "end": { "line": 34, "column": 99, "offset": 1310 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 34, "column": 50, "offset": 1261 },
                      "end": { "line": 34, "column": 101, "offset": 1312 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": ".",
                    "position": {
                      "start": { "line": 34, "column": 101, "offset": 1312 },
                      "end": { "line": 34, "column": 102, "offset": 1313 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 34, "column": 3, "offset": 1214 },
                  "end": { "line": 34, "column": 102, "offset": 1313 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 34, "column": 1, "offset": 1212 },
              "end": { "line": 34, "column": 102, "offset": 1313 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 31, "column": 1, "offset": 1051 },
          "end": { "line": 34, "column": 102, "offset": 1313 },
          "indent": [1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Measure Performance Impact",
            "position": {
              "start": { "line": 36, "column": 4, "offset": 1318 },
              "end": { "line": 36, "column": 30, "offset": 1344 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 36, "column": 1, "offset": 1315 },
          "end": { "line": 36, "column": 30, "offset": 1344 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The performance impact of control divergence decreases with the ",
            "position": {
              "start": { "line": 38, "column": 1, "offset": 1346 },
              "end": { "line": 38, "column": 65, "offset": 1410 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "size",
                "position": {
                  "start": { "line": 38, "column": 67, "offset": 1412 },
                  "end": { "line": 38, "column": 71, "offset": 1416 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 38, "column": 65, "offset": 1410 },
              "end": { "line": 38, "column": 73, "offset": 1418 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " of the vectors being processed.",
            "position": {
              "start": { "line": 38, "column": 73, "offset": 1418 },
              "end": { "line": 38, "column": 105, "offset": 1450 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 38, "column": 1, "offset": 1346 },
          "end": { "line": 38, "column": 105, "offset": 1450 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": true,
        "children": [
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "For a vector length of 100, one of the four warps will have control divergence, which can have significant impact on performance.",
                    "position": {
                      "start": { "line": 40, "column": 3, "offset": 1454 },
                      "end": { "line": 40, "column": 132, "offset": 1583 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 40, "column": 3, "offset": 1454 },
                  "end": { "line": 40, "column": 132, "offset": 1583 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 40, "column": 1, "offset": 1452 },
              "end": { "line": 41, "column": 1, "offset": 1584 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "For a vector size of 1000, only one out of the 32 warps will have control divergence. That is, control divergence will affect only about 3% of the execution time. Even if it doubles the execution time of the warp, the net impact to the total execution time will be about 3%.",
                    "position": {
                      "start": { "line": 42, "column": 3, "offset": 1587 },
                      "end": { "line": 42, "column": 277, "offset": 1861 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 42, "column": 3, "offset": 1587 },
                  "end": { "line": 42, "column": 277, "offset": 1861 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 42, "column": 1, "offset": 1585 },
              "end": { "line": 43, "column": 1, "offset": 1862 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Obviously, if the vector length is 10,000 or more, only one of the 313 warps will have control divergence. The impact of control divergence will be much less than 1%!",
                    "position": {
                      "start": { "line": 44, "column": 3, "offset": 1865 },
                      "end": { "line": 44, "column": 169, "offset": 2031 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 44, "column": 3, "offset": 1865 },
                  "end": { "line": 44, "column": 169, "offset": 2031 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 44, "column": 1, "offset": 1863 },
              "end": { "line": 44, "column": 169, "offset": 2031 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 40, "column": 1, "offset": 1452 },
          "end": { "line": 44, "column": 169, "offset": 2031 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "2D blocks example",
            "position": {
              "start": { "line": 46, "column": 5, "offset": 2037 },
              "end": { "line": 46, "column": 22, "offset": 2054 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 46, "column": 1, "offset": 2033 },
          "end": { "line": 46, "column": 22, "offset": 2054 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "For two-dimensional data, if-statements are also used to handle the boundary conditions for threads that operate at the edge of the data.",
            "position": {
              "start": { "line": 48, "column": 1, "offset": 2056 },
              "end": { "line": 48, "column": 138, "offset": 2193 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 48, "column": 1, "offset": 2056 },
          "end": { "line": 48, "column": 138, "offset": 2193 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "settings",
            "position": {
              "start": { "line": 50, "column": 6, "offset": 2200 },
              "end": { "line": 50, "column": 14, "offset": 2208 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 50, "column": 1, "offset": 2195 },
          "end": { "line": 50, "column": 14, "offset": 2208 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "given a block size of 16 x 16",
                    "position": {
                      "start": { "line": 52, "column": 3, "offset": 2212 },
                      "end": { "line": 52, "column": 32, "offset": 2241 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 52, "column": 3, "offset": 2212 },
                  "end": { "line": 52, "column": 32, "offset": 2241 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 52, "column": 1, "offset": 2210 },
              "end": { "line": 52, "column": 32, "offset": 2241 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 52, "column": 1, "offset": 2210 },
          "end": { "line": 52, "column": 32, "offset": 2241 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "html",
            "title": null,
            "url": "./grid.jpg",
            "alt": "grid",
            "position": {
              "start": { "line": 54, "column": 1, "offset": 2243 },
              "end": { "line": 54, "column": 20, "offset": 2262 },
              "indent": []
            },
            "value": "<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6780a2f7c16d844af42ab0b464810e2c/7fc32/grid.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 64.69999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAC/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABYZwjVR//xAAYEAEAAwEAAAAAAAAAAAAAAAABAAMQBP/aAAgBAQABBQK5XCdO/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQEABj8CNMpf/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERMRAhgf/aAAgBAQABPyGXYlC3ZAlo/9oADAMBAAIAAwAAABBQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB4QAAMAAQQDAAAAAAAAAAAAAAABEYEhMUFRcbHw/9oACAEBAAE/EEtsqko9djnPR8QS+P2RNyKQ/9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"grid\"\n        title=\"\"\n        src=\"/static/6780a2f7c16d844af42ab0b464810e2c/1697e/grid.jpg\"\n        srcset=\"/static/6780a2f7c16d844af42ab0b464810e2c/a2cfd/grid.jpg 148w,\n/static/6780a2f7c16d844af42ab0b464810e2c/3348f/grid.jpg 295w,\n/static/6780a2f7c16d844af42ab0b464810e2c/1697e/grid.jpg 590w,\n/static/6780a2f7c16d844af42ab0b464810e2c/6a00a/grid.jpg 885w,\n/static/6780a2f7c16d844af42ab0b464810e2c/7fc32/grid.jpg 1000w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a>"
          }
        ],
        "position": {
          "start": { "line": 54, "column": 1, "offset": 2243 },
          "end": { "line": 54, "column": 20, "offset": 2262 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "data to be processed is of the size 76×62",
                    "position": {
                      "start": { "line": 56, "column": 3, "offset": 2266 },
                      "end": { "line": 56, "column": 44, "offset": 2307 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 56, "column": 3, "offset": 2266 },
                  "end": { "line": 56, "column": 44, "offset": 2307 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 56, "column": 1, "offset": 2264 },
              "end": { "line": 56, "column": 44, "offset": 2307 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 56, "column": 1, "offset": 2264 },
          "end": { "line": 56, "column": 44, "offset": 2307 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "map data to blocks then warps",
            "position": {
              "start": { "line": 58, "column": 6, "offset": 2314 },
              "end": { "line": 58, "column": 35, "offset": 2343 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 58, "column": 1, "offset": 2309 },
          "end": { "line": 58, "column": 35, "offset": 2343 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": true,
        "children": [
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "20 = 5",
                    "position": {
                      "start": { "line": 60, "column": 3, "offset": 2347 },
                      "end": { "line": 60, "column": 9, "offset": 2353 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 60, "column": 9, "offset": 2353 },
                      "end": { "line": 60, "column": 11, "offset": 2355 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "4 ",
                    "position": {
                      "start": { "line": 60, "column": 11, "offset": 2355 },
                      "end": { "line": 60, "column": 13, "offset": 2357 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "blocks",
                        "position": {
                          "start": { "line": 60, "column": 15, "offset": 2359 },
                          "end": { "line": 60, "column": 21, "offset": 2365 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 60, "column": 13, "offset": 2357 },
                      "end": { "line": 60, "column": 23, "offset": 2367 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " will be used",
                    "position": {
                      "start": { "line": 60, "column": 23, "offset": 2367 },
                      "end": { "line": 60, "column": 36, "offset": 2380 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 60, "column": 3, "offset": 2347 },
                  "end": { "line": 60, "column": 36, "offset": 2380 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 60, "column": 1, "offset": 2345 },
              "end": { "line": 61, "column": 1, "offset": 2381 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "each block will be partitioned into 8 ",
                    "position": {
                      "start": { "line": 62, "column": 3, "offset": 2384 },
                      "end": { "line": 62, "column": 41, "offset": 2422 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "warps",
                        "position": {
                          "start": { "line": 62, "column": 43, "offset": 2424 },
                          "end": { "line": 62, "column": 48, "offset": 2429 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 62, "column": 41, "offset": 2422 },
                      "end": { "line": 62, "column": 50, "offset": 2431 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " (16 ",
                    "position": {
                      "start": { "line": 62, "column": 50, "offset": 2431 },
                      "end": { "line": 62, "column": 55, "offset": 2436 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 62, "column": 55, "offset": 2436 },
                      "end": { "line": 62, "column": 57, "offset": 2438 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " 16 / 32), each one consists of two rows of a block",
                    "position": {
                      "start": { "line": 62, "column": 57, "offset": 2438 },
                      "end": { "line": 62, "column": 108, "offset": 2489 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 62, "column": 3, "offset": 2384 },
                  "end": { "line": 62, "column": 108, "offset": 2489 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 62, "column": 1, "offset": 2382 },
              "end": { "line": 63, "column": 1, "offset": 2490 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "there are a total 160 warps (8 warps per block) involved",
                    "position": {
                      "start": { "line": 64, "column": 3, "offset": 2493 },
                      "end": { "line": 64, "column": 59, "offset": 2549 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 64, "column": 3, "offset": 2493 },
                  "end": { "line": 64, "column": 59, "offset": 2549 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 64, "column": 1, "offset": 2491 },
              "end": { "line": 64, "column": 59, "offset": 2549 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 60, "column": 1, "offset": 2345 },
          "end": { "line": 64, "column": 59, "offset": 2549 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "measure performance impact of control divergence",
            "position": {
              "start": { "line": 66, "column": 6, "offset": 2556 },
              "end": { "line": 66, "column": 54, "offset": 2604 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 66, "column": 1, "offset": 2551 },
          "end": { "line": 66, "column": 54, "offset": 2604 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": false,
        "children": [
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "none of the warps in the 12 blocks (12",
                    "position": {
                      "start": { "line": 68, "column": 3, "offset": 2608 },
                      "end": { "line": 68, "column": 41, "offset": 2646 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 68, "column": 41, "offset": 2646 },
                      "end": { "line": 68, "column": 43, "offset": 2648 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "8 = 96 warps) in region 1 will have control divergence.",
                    "position": {
                      "start": { "line": 68, "column": 43, "offset": 2648 },
                      "end": { "line": 68, "column": 98, "offset": 2703 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 68, "column": 3, "offset": 2608 },
                  "end": { "line": 68, "column": 98, "offset": 2703 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 68, "column": 1, "offset": 2606 },
              "end": { "line": 68, "column": 98, "offset": 2703 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 68, "column": 1, "offset": 2606 },
          "end": { "line": 68, "column": 98, "offset": 2703 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "html",
            "title": null,
            "url": "./performance.jpg",
            "alt": "performance",
            "position": {
              "start": { "line": 70, "column": 1, "offset": 2705 },
              "end": { "line": 70, "column": 34, "offset": 2738 },
              "indent": []
            },
            "value": "<a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c846dac029978fa69362f9ab79a7127d/7fc32/performance.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAgP/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFqbcSNnUP/xAAbEAEAAgIDAAAAAAAAAAAAAAABAAQDEhEhMv/aAAgBAQABBQKyukx+bByaEDr/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAQIQECEf/aAAgBAQAGPwKupmD/AP/EABsQAAMAAgMAAAAAAAAAAAAAAAABESExUWHw/9oACAEBAAE/IXYaN9TSJt5OkUlwf//aAAwDAQACAAMAAAAQoA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMZFBsf/aAAgBAQABPxB9zgAaxUtW3UW2PnwgUbpJyNOvCHADE//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"performance\"\n        title=\"\"\n        src=\"/static/c846dac029978fa69362f9ab79a7127d/1697e/performance.jpg\"\n        srcset=\"/static/c846dac029978fa69362f9ab79a7127d/a2cfd/performance.jpg 148w,\n/static/c846dac029978fa69362f9ab79a7127d/3348f/performance.jpg 295w,\n/static/c846dac029978fa69362f9ab79a7127d/1697e/performance.jpg 590w,\n/static/c846dac029978fa69362f9ab79a7127d/6a00a/performance.jpg 885w,\n/static/c846dac029978fa69362f9ab79a7127d/7fc32/performance.jpg 1000w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a>"
          }
        ],
        "position": {
          "start": { "line": 70, "column": 1, "offset": 2705 },
          "end": { "line": 70, "column": 34, "offset": 2738 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": true,
        "children": [
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "for region 2, all the (3 ",
                    "position": {
                      "start": { "line": 72, "column": 3, "offset": 2742 },
                      "end": { "line": 72, "column": 28, "offset": 2767 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": "*",
                    "position": {
                      "start": { "line": 72, "column": 28, "offset": 2767 },
                      "end": { "line": 72, "column": 30, "offset": 2769 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " 8 = 24) warps will have control divergence.",
                    "position": {
                      "start": { "line": 72, "column": 30, "offset": 2769 },
                      "end": { "line": 72, "column": 74, "offset": 2813 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 72, "column": 3, "offset": 2742 },
                  "end": { "line": 72, "column": 74, "offset": 2813 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 72, "column": 1, "offset": 2740 },
              "end": { "line": 73, "column": 1, "offset": 2814 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "for region 3, note that all the bottom warps are mapped to data that are completely outside the picture. As a result, ",
                    "position": {
                      "start": { "line": 74, "column": 3, "offset": 2817 },
                      "end": { "line": 74, "column": 121, "offset": 2935 },
                      "indent": []
                    }
                  },
                  {
                    "type": "strong",
                    "children": [
                      {
                        "type": "text",
                        "value": "none of them will pass the if-condition",
                        "position": {
                          "start": {
                            "line": 74,
                            "column": 123,
                            "offset": 2937
                          },
                          "end": { "line": 74, "column": 162, "offset": 2976 },
                          "indent": []
                        }
                      }
                    ],
                    "position": {
                      "start": { "line": 74, "column": 121, "offset": 2935 },
                      "end": { "line": 74, "column": 164, "offset": 2978 },
                      "indent": []
                    }
                  },
                  {
                    "type": "text",
                    "value": " 🙀. (If the picture had an odd number of pixels in the vertical dimension, these warps would have had control divergence). Since they all follow the same control flow path, none of these 32 warps will have control divergence!",
                    "position": {
                      "start": { "line": 74, "column": 164, "offset": 2978 },
                      "end": { "line": 74, "column": 390, "offset": 3204 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 74, "column": 3, "offset": 2817 },
                  "end": { "line": 74, "column": 390, "offset": 3204 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 74, "column": 1, "offset": 2815 },
              "end": { "line": 75, "column": 1, "offset": 3205 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "for region 4, the first 7 warps will have control divergence but the last warp will not.",
                    "position": {
                      "start": { "line": 76, "column": 3, "offset": 3208 },
                      "end": { "line": 76, "column": 91, "offset": 3296 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 76, "column": 3, "offset": 3208 },
                  "end": { "line": 76, "column": 91, "offset": 3296 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 76, "column": 1, "offset": 3206 },
              "end": { "line": 76, "column": 91, "offset": 3296 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 72, "column": 1, "offset": 2740 },
          "end": { "line": 76, "column": 91, "offset": 3296 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "All in all, 31 out of the 160 warps will have control divergence.",
            "position": {
              "start": { "line": 78, "column": 1, "offset": 3298 },
              "end": { "line": 78, "column": 66, "offset": 3363 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 78, "column": 1, "offset": 3298 },
          "end": { "line": 78, "column": 66, "offset": 3363 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 4,
        "children": [
          {
            "type": "text",
            "value": "increase the horizontal dimension of data",
            "position": {
              "start": { "line": 80, "column": 6, "offset": 3370 },
              "end": { "line": 80, "column": 47, "offset": 3411 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 80, "column": 1, "offset": 3365 },
          "end": { "line": 80, "column": 47, "offset": 3411 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Once again, the performance impact of control divergence decreases as the number of data in the horizontal dimension increases.",
            "position": {
              "start": { "line": 82, "column": 1, "offset": 3413 },
              "end": { "line": 82, "column": 128, "offset": 3540 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 82, "column": 1, "offset": 3413 },
          "end": { "line": 82, "column": 128, "offset": 3540 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "For example, if we process some data of size 200×150 with 16×16 blocks, there will be a total ",
            "position": {
              "start": { "line": 84, "column": 1, "offset": 3542 },
              "end": { "line": 84, "column": 95, "offset": 3636 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">130 =13*10</code>",
            "position": {
              "start": { "line": 84, "column": 95, "offset": 3636 },
              "end": { "line": 84, "column": 107, "offset": 3648 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " thread blocks or 1040 warps. The number of warps in regions 1 through 4 will be ",
            "position": {
              "start": { "line": 84, "column": 107, "offset": 3648 },
              "end": { "line": 84, "column": 188, "offset": 3729 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">864 (12*9*8)</code>",
            "position": {
              "start": { "line": 84, "column": 188, "offset": 3729 },
              "end": { "line": 84, "column": 202, "offset": 3743 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", ",
            "position": {
              "start": { "line": 84, "column": 202, "offset": 3743 },
              "end": { "line": 84, "column": 204, "offset": 3745 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">72 (9*8)</code>",
            "position": {
              "start": { "line": 84, "column": 204, "offset": 3745 },
              "end": { "line": 84, "column": 214, "offset": 3755 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", ",
            "position": {
              "start": { "line": 84, "column": 214, "offset": 3755 },
              "end": { "line": 84, "column": 216, "offset": 3757 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">96 (12*8)</code>",
            "position": {
              "start": { "line": 84, "column": 216, "offset": 3757 },
              "end": { "line": 84, "column": 227, "offset": 3768 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ", and ",
            "position": {
              "start": { "line": 84, "column": 227, "offset": 3768 },
              "end": { "line": 84, "column": 233, "offset": 3774 },
              "indent": []
            }
          },
          {
            "type": "html",
            "value": "<code class=\"language-text\">8 (1*8)</code>",
            "position": {
              "start": { "line": 84, "column": 233, "offset": 3774 },
              "end": { "line": 84, "column": 242, "offset": 3783 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ". Only 80 of these warps will have control divergence. Thus, the performance impact of control divergence will be less than 8%.",
            "position": {
              "start": { "line": 84, "column": 242, "offset": 3783 },
              "end": { "line": 84, "column": 369, "offset": 3910 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 84, "column": 1, "offset": 3542 },
          "end": { "line": 84, "column": 369, "offset": 3910 },
          "indent": []
        }
      }
    ],
    "position": {
      "start": { "line": 1, "column": 1, "offset": 0 },
      "end": { "line": 85, "column": 1, "offset": 3911 }
    }
  }
}
