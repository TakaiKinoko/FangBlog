{"expireTime":9007200830662201000,"key":"transformer-remark-markdown-html-ast-b1c8faf708e57edb06cf472335488ec2-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-reading-time-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the last post, we saw how full concurrency can be achieved amongst streams. Here I’d like to talk about how CUDA operations from different streams may also be ","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":163,"offset":163}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"interleaved","position":{"start":{"line":2,"column":165,"offset":165},"end":{"line":2,"column":176,"offset":176}}}],"position":{"start":{"line":2,"column":163,"offset":163},"end":{"line":2,"column":178,"offset":178}}},{"type":"text","value":", which is another programming model often used to effect concurrency.","position":{"start":{"line":2,"column":178,"offset":178},"end":{"line":2,"column":248,"offset":248}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":248,"offset":248}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Review CUDA Streams","position":{"start":{"line":4,"column":5,"offset":254},"end":{"line":4,"column":24,"offset":273}}}],"position":{"start":{"line":4,"column":1,"offset":250},"end":{"line":4,"column":24,"offset":273}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A stream in CUDA is a sequence of operations that execute on the device in the order in which they are issued by the host code.","position":{"start":{"line":6,"column":1,"offset":275},"end":{"line":6,"column":128,"offset":402}}}],"position":{"start":{"line":6,"column":1,"offset":275},"end":{"line":6,"column":128,"offset":402}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"While operations within a stream are guaranteed to execute in the prescribed order, operations in different streams can be ","position":{"start":{"line":8,"column":1,"offset":404},"end":{"line":8,"column":124,"offset":527}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"interleaved","position":{"start":{"line":8,"column":126,"offset":529},"end":{"line":8,"column":137,"offset":540}}}],"position":{"start":{"line":8,"column":124,"offset":527},"end":{"line":8,"column":139,"offset":542}}},{"type":"text","value":" and, when possible, they can even run ","position":{"start":{"line":8,"column":139,"offset":542},"end":{"line":8,"column":178,"offset":581}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"concurrently","position":{"start":{"line":8,"column":180,"offset":583},"end":{"line":8,"column":192,"offset":595}}}],"position":{"start":{"line":8,"column":178,"offset":581},"end":{"line":8,"column":194,"offset":597}}},{"type":"text","value":".","position":{"start":{"line":8,"column":194,"offset":597},"end":{"line":8,"column":195,"offset":598}}}],"position":{"start":{"line":8,"column":1,"offset":404},"end":{"line":8,"column":195,"offset":598}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Review CUDA Asynchronous Commands","position":{"start":{"line":10,"column":5,"offset":604},"end":{"line":10,"column":38,"offset":637}}}],"position":{"start":{"line":10,"column":1,"offset":600},"end":{"line":10,"column":38,"offset":637}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Being asynchronous means that CUDA can perform these operations simultaneously","position":{"start":{"line":12,"column":1,"offset":639},"end":{"line":12,"column":79,"offset":717}}}],"position":{"start":{"line":12,"column":1,"offset":639},"end":{"line":12,"column":79,"offset":717}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"CUDA Kernel <<<>>>","position":{"start":{"line":14,"column":3,"offset":721},"end":{"line":14,"column":21,"offset":739}}}],"position":{"start":{"line":14,"column":1,"offset":719},"end":{"line":15,"column":1,"offset":740}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMemcpyAsync (HostToDevice)","position":{"start":{"line":16,"column":3,"offset":743},"end":{"line":16,"column":33,"offset":773}}}],"position":{"start":{"line":16,"column":1,"offset":741},"end":{"line":17,"column":1,"offset":774}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMemcpyAsync (DeviceToHost)","position":{"start":{"line":18,"column":3,"offset":777},"end":{"line":18,"column":33,"offset":807}}}],"position":{"start":{"line":18,"column":1,"offset":775},"end":{"line":19,"column":1,"offset":808}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Operations on the CPU","position":{"start":{"line":20,"column":3,"offset":811},"end":{"line":20,"column":24,"offset":832}}}],"position":{"start":{"line":20,"column":1,"offset":809},"end":{"line":20,"column":24,"offset":832}}},{"type":"text","value":"\n"}],"position":{"start":{"line":14,"column":1,"offset":719},"end":{"line":20,"column":24,"offset":832}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"🌟 What Can Happen Simultaneously 🌟","position":{"start":{"line":22,"column":5,"offset":838},"end":{"line":22,"column":41,"offset":874}}}],"position":{"start":{"line":22,"column":1,"offset":834},"end":{"line":22,"column":41,"offset":874}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"computation on the device","position":{"start":{"line":24,"column":3,"offset":878},"end":{"line":24,"column":28,"offset":903}}}],"position":{"start":{"line":24,"column":3,"offset":878},"end":{"line":24,"column":28,"offset":903}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"lots of CUDA kernels on GPU","position":{"start":{"line":26,"column":5,"offset":909},"end":{"line":26,"column":32,"offset":936}}}],"position":{"start":{"line":26,"column":3,"offset":907},"end":{"line":26,"column":32,"offset":936}}},{"type":"text","value":"\n"}],"position":{"start":{"line":26,"column":3,"offset":907},"end":{"line":26,"column":32,"offset":936}}},{"type":"text","value":"\n"}],"position":{"start":{"line":24,"column":1,"offset":876},"end":{"line":27,"column":1,"offset":937}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"data transfers between the host and device","position":{"start":{"line":28,"column":3,"offset":940},"end":{"line":28,"column":45,"offset":982}}}],"position":{"start":{"line":28,"column":3,"offset":940},"end":{"line":28,"column":45,"offset":982}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">cudaMemcpyAsyncs</code>","position":{"start":{"line":30,"column":5,"offset":988},"end":{"line":30,"column":23,"offset":1006}}},{"type":"text","value":" both HostToDevice and DeviceToHost","position":{"start":{"line":30,"column":23,"offset":1006},"end":{"line":30,"column":58,"offset":1041}}}],"position":{"start":{"line":30,"column":3,"offset":986},"end":{"line":30,"column":58,"offset":1041}}},{"type":"text","value":"\n"}],"position":{"start":{"line":30,"column":3,"offset":986},"end":{"line":30,"column":58,"offset":1041}}},{"type":"text","value":"\n"}],"position":{"start":{"line":28,"column":1,"offset":938},"end":{"line":31,"column":1,"offset":1042}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"computation on the CPU","position":{"start":{"line":32,"column":3,"offset":1045},"end":{"line":32,"column":25,"offset":1067}}}],"position":{"start":{"line":32,"column":1,"offset":1043},"end":{"line":32,"column":25,"offset":1067}}},{"type":"text","value":"\n"}],"position":{"start":{"line":24,"column":1,"offset":876},"end":{"line":32,"column":25,"offset":1067}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"No Concurrency","position":{"start":{"line":34,"column":4,"offset":1072},"end":{"line":34,"column":18,"offset":1086}}}],"position":{"start":{"line":34,"column":1,"offset":1069},"end":{"line":34,"column":18,"offset":1086}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The two examples below are completely synchronous:","position":{"start":{"line":36,"column":1,"offset":1088},"end":{"line":36,"column":51,"offset":1138}}}],"position":{"start":{"line":36,"column":1,"offset":1088},"end":{"line":36,"column":51,"offset":1138}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"example 1","position":{"start":{"line":38,"column":5,"offset":1144},"end":{"line":38,"column":14,"offset":1153}}}],"position":{"start":{"line":38,"column":1,"offset":1140},"end":{"line":38,"column":14,"offset":1153}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">cudaMemcpy</span><span class=\"token punctuation\">(</span>d_a<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> numBytes<span class=\"token punctuation\">,</span> cudaMemcpyHostToDevice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nincrement<span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>N<span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>d_a<span class=\"token punctuation\">)</span>\n<span class=\"token function\">cudaMemcpy</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> d_a<span class=\"token punctuation\">,</span> numBytes<span class=\"token punctuation\">,</span> cudaMemcpyDeviceToHost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":40,"column":1,"offset":1155},"end":{"line":44,"column":4,"offset":1295}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From the perspective of the ","position":{"start":{"line":46,"column":3,"offset":1299},"end":{"line":46,"column":31,"offset":1327}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"device","position":{"start":{"line":46,"column":33,"offset":1329},"end":{"line":46,"column":39,"offset":1335}}}],"position":{"start":{"line":46,"column":31,"offset":1327},"end":{"line":46,"column":41,"offset":1337}}},{"type":"text","value":":","position":{"start":{"line":46,"column":41,"offset":1337},"end":{"line":46,"column":42,"offset":1338}}}],"position":{"start":{"line":46,"column":3,"offset":1299},"end":{"line":46,"column":42,"offset":1338}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"all three operations are issued to the same (default) stream, thus will execute in the order that they were issued","position":{"start":{"line":48,"column":5,"offset":1344},"end":{"line":48,"column":119,"offset":1458}}}],"position":{"start":{"line":48,"column":3,"offset":1342},"end":{"line":48,"column":119,"offset":1458}}},{"type":"text","value":"\n"}],"position":{"start":{"line":48,"column":3,"offset":1342},"end":{"line":48,"column":119,"offset":1458}}},{"type":"text","value":"\n"}],"position":{"start":{"line":46,"column":1,"offset":1297},"end":{"line":49,"column":1,"offset":1459}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From the perspective of the ","position":{"start":{"line":50,"column":3,"offset":1462},"end":{"line":50,"column":31,"offset":1490}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"host","position":{"start":{"line":50,"column":33,"offset":1492},"end":{"line":50,"column":37,"offset":1496}}}],"position":{"start":{"line":50,"column":31,"offset":1490},"end":{"line":50,"column":39,"offset":1498}}},{"type":"text","value":":","position":{"start":{"line":50,"column":39,"offset":1498},"end":{"line":50,"column":40,"offset":1499}}}],"position":{"start":{"line":50,"column":3,"offset":1462},"end":{"line":50,"column":40,"offset":1499}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"the implicit data transfers are blocking or synchronous transfers","position":{"start":{"line":51,"column":5,"offset":1504},"end":{"line":51,"column":70,"offset":1569}}}],"position":{"start":{"line":51,"column":3,"offset":1502},"end":{"line":51,"column":70,"offset":1569}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"the kernel launch is asynchronous","position":{"start":{"line":52,"column":5,"offset":1574},"end":{"line":52,"column":38,"offset":1607}}}],"position":{"start":{"line":52,"column":3,"offset":1572},"end":{"line":52,"column":38,"offset":1607}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"😳","position":{"start":{"line":53,"column":5,"offset":1612},"end":{"line":53,"column":7,"offset":1614}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Since the host-to-device data transfer on the first line is synchronous, the CPU thread will not reach the kernel call on the second line until the host-to-device transfer is complete","position":{"start":{"line":53,"column":9,"offset":1616},"end":{"line":53,"column":192,"offset":1799}}}],"position":{"start":{"line":53,"column":7,"offset":1614},"end":{"line":53,"column":194,"offset":1801}}},{"type":"text","value":". Once the kernel is issued, the CPU thread moves to the third line, but the transfer on that line cannot begin due to the device-side order of execution.","position":{"start":{"line":53,"column":194,"offset":1801},"end":{"line":53,"column":348,"offset":1955}}}],"position":{"start":{"line":53,"column":3,"offset":1610},"end":{"line":53,"column":348,"offset":1955}}},{"type":"text","value":"\n"}],"position":{"start":{"line":51,"column":3,"offset":1502},"end":{"line":53,"column":348,"offset":1955}}},{"type":"text","value":"\n"}],"position":{"start":{"line":50,"column":1,"offset":1460},"end":{"line":53,"column":348,"offset":1955}}},{"type":"text","value":"\n"}],"position":{"start":{"line":46,"column":1,"offset":1297},"end":{"line":53,"column":348,"offset":1955}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"example 2","position":{"start":{"line":55,"column":5,"offset":1961},"end":{"line":55,"column":14,"offset":1970}}}],"position":{"start":{"line":55,"column":1,"offset":1957},"end":{"line":55,"column":14,"offset":1970}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">cudaMemcpy <span class=\"token punctuation\">(</span> dev1<span class=\"token punctuation\">,</span> host1<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> H2D <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\nkernel2 <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> grid<span class=\"token punctuation\">,</span> block<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span> …<span class=\"token punctuation\">,</span> dev2<span class=\"token punctuation\">,</span> … <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\nkernel3 <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> grid<span class=\"token punctuation\">,</span> block<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span> …<span class=\"token punctuation\">,</span> dev3<span class=\"token punctuation\">,</span> … <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\ncudaMemcpy <span class=\"token punctuation\">(</span> host4<span class=\"token punctuation\">,</span> dev4<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> D2H <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":57,"column":1,"offset":1972},"end":{"line":62,"column":4,"offset":2156}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"All CUDA operations in the default stream are synchronous.","position":{"start":{"line":64,"column":1,"offset":2158},"end":{"line":64,"column":59,"offset":2216}}}],"position":{"start":{"line":64,"column":1,"offset":2158},"end":{"line":64,"column":59,"offset":2216}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Overlap Device and Host Computation","position":{"start":{"line":66,"column":4,"offset":2221},"end":{"line":66,"column":39,"offset":2256}}}],"position":{"start":{"line":66,"column":1,"offset":2218},"end":{"line":66,"column":39,"offset":2256}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The asynchronous behavior of kernel launches from the host’s perspective makes ","position":{"start":{"line":68,"column":1,"offset":2258},"end":{"line":68,"column":80,"offset":2337}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"overlapping device and host computation","position":{"start":{"line":68,"column":82,"offset":2339},"end":{"line":68,"column":121,"offset":2378}}}],"position":{"start":{"line":68,"column":80,"offset":2337},"end":{"line":68,"column":123,"offset":2380}}},{"type":"text","value":" very simple.","position":{"start":{"line":68,"column":123,"offset":2380},"end":{"line":68,"column":136,"offset":2393}}}],"position":{"start":{"line":68,"column":1,"offset":2258},"end":{"line":68,"column":136,"offset":2393}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the modified code below, an independent CPU computation is added:","position":{"start":{"line":70,"column":1,"offset":2395},"end":{"line":70,"column":69,"offset":2463}}}],"position":{"start":{"line":70,"column":1,"offset":2395},"end":{"line":70,"column":69,"offset":2463}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">cudaMemcpy</span><span class=\"token punctuation\">(</span>d_a<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> numBytes<span class=\"token punctuation\">,</span> cudaMemcpyHostToDevice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nincrement<span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>N<span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>d_a<span class=\"token punctuation\">)</span>\n<span class=\"token function\">myCpuFunction</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token function\">cudaMemcpy</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> d_a<span class=\"token punctuation\">,</span> numBytes<span class=\"token punctuation\">,</span> cudaMemcpyDeviceToHost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":72,"column":1,"offset":2465},"end":{"line":77,"column":4,"offset":2622}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As soon as the ","position":{"start":{"line":79,"column":1,"offset":2624},"end":{"line":79,"column":16,"offset":2639}}},{"type":"raw","value":"<code class=\"language-text\">increment()</code>","position":{"start":{"line":79,"column":16,"offset":2639},"end":{"line":79,"column":29,"offset":2652}}},{"type":"text","value":" kernel is launched on the device the CPU thread executes myCpuFunction(), ","position":{"start":{"line":79,"column":29,"offset":2652},"end":{"line":79,"column":104,"offset":2727}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"overlapping its execution on the CPU with the kernel execution on the GPU","position":{"start":{"line":79,"column":106,"offset":2729},"end":{"line":79,"column":179,"offset":2802}}}],"position":{"start":{"line":79,"column":104,"offset":2727},"end":{"line":79,"column":181,"offset":2804}}},{"type":"text","value":".","position":{"start":{"line":79,"column":181,"offset":2804},"end":{"line":79,"column":182,"offset":2805}}}],"position":{"start":{"line":79,"column":1,"offset":2624},"end":{"line":79,"column":182,"offset":2805}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Whether the host function or device kernel completes first doesn’t affect the subsequent device-to-host transfer, which will begin only after the kernel completes.","position":{"start":{"line":81,"column":1,"offset":2807},"end":{"line":81,"column":164,"offset":2970}}}],"position":{"start":{"line":81,"column":1,"offset":2807},"end":{"line":81,"column":164,"offset":2970}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From the perspective of the device, nothing has changed from the previous example; the device is completely unaware of myCpuFunction().","position":{"start":{"line":83,"column":1,"offset":2972},"end":{"line":83,"column":136,"offset":3107}}}],"position":{"start":{"line":83,"column":1,"offset":2972},"end":{"line":83,"column":136,"offset":3107}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{},"children":[{"type":"text","value":"special note","position":{"start":{"line":85,"column":6,"offset":3114},"end":{"line":85,"column":18,"offset":3126}}}],"position":{"start":{"line":85,"column":1,"offset":3109},"end":{"line":85,"column":18,"offset":3126}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"GPU kernels are asynchronous with host by default.","position":{"start":{"line":87,"column":1,"offset":3128},"end":{"line":87,"column":51,"offset":3178}}}],"position":{"start":{"line":87,"column":1,"offset":3128},"end":{"line":87,"column":51,"offset":3178}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Requirements For Concurrency","position":{"start":{"line":89,"column":4,"offset":3183},"end":{"line":89,"column":32,"offset":3211}}}],"position":{"start":{"line":89,"column":1,"offset":3180},"end":{"line":89,"column":32,"offset":3211}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The kernel execution and the data transfer to be overlapped must ","position":{"start":{"line":91,"column":3,"offset":3215},"end":{"line":91,"column":68,"offset":3280}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"both occur in different, non-default streams","position":{"start":{"line":91,"column":70,"offset":3282},"end":{"line":91,"column":114,"offset":3326}}}],"position":{"start":{"line":91,"column":68,"offset":3280},"end":{"line":91,"column":116,"offset":3328}}},{"type":"text","value":".","position":{"start":{"line":91,"column":116,"offset":3328},"end":{"line":91,"column":117,"offset":3329}}}],"position":{"start":{"line":91,"column":1,"offset":3213},"end":{"line":92,"column":1,"offset":3330}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Must ","position":{"start":{"line":93,"column":3,"offset":3333},"end":{"line":93,"column":8,"offset":3338}}},{"type":"raw","value":"<code class=\"language-text\">cudaMemcpyAsync</code>","position":{"start":{"line":93,"column":8,"offset":3338},"end":{"line":93,"column":25,"offset":3355}}},{"type":"text","value":" with host from ‘pinned’ memory","position":{"start":{"line":93,"column":25,"offset":3355},"end":{"line":93,"column":56,"offset":3386}}}],"position":{"start":{"line":93,"column":3,"offset":3333},"end":{"line":93,"column":56,"offset":3386}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Page-locked memory","position":{"start":{"line":95,"column":5,"offset":3392},"end":{"line":95,"column":23,"offset":3410}}}],"position":{"start":{"line":95,"column":3,"offset":3390},"end":{"line":95,"column":23,"offset":3410}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Allocated using cudaMallocHost() or cudaHostAlloc()","position":{"start":{"line":96,"column":5,"offset":3415},"end":{"line":96,"column":56,"offset":3466}}}],"position":{"start":{"line":96,"column":3,"offset":3413},"end":{"line":96,"column":56,"offset":3466}}},{"type":"text","value":"\n"}],"position":{"start":{"line":95,"column":3,"offset":3390},"end":{"line":96,"column":56,"offset":3466}}},{"type":"text","value":"\n"}],"position":{"start":{"line":93,"column":1,"offset":3331},"end":{"line":97,"column":1,"offset":3467}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Sufficient resources must be available","position":{"start":{"line":98,"column":3,"offset":3470},"end":{"line":98,"column":41,"offset":3508}}}],"position":{"start":{"line":98,"column":3,"offset":3470},"end":{"line":98,"column":41,"offset":3508}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMemcpyAsyncs in different directions","position":{"start":{"line":99,"column":5,"offset":3513},"end":{"line":99,"column":45,"offset":3553}}}],"position":{"start":{"line":99,"column":3,"offset":3511},"end":{"line":99,"column":45,"offset":3553}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Device resources (SMEM, registers, blocks, etc.)","position":{"start":{"line":100,"column":5,"offset":3558},"end":{"line":100,"column":53,"offset":3606}}}],"position":{"start":{"line":100,"column":3,"offset":3556},"end":{"line":100,"column":53,"offset":3606}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The device must be capable of “concurrent copy and execution”","position":{"start":{"line":101,"column":5,"offset":3611},"end":{"line":101,"column":66,"offset":3672}}}],"position":{"start":{"line":101,"column":3,"offset":3609},"end":{"line":101,"column":66,"offset":3672}}},{"type":"text","value":"\n"}],"position":{"start":{"line":99,"column":3,"offset":3511},"end":{"line":101,"column":66,"offset":3672}}},{"type":"text","value":"\n"}],"position":{"start":{"line":98,"column":1,"offset":3468},"end":{"line":101,"column":66,"offset":3672}}},{"type":"text","value":"\n"}],"position":{"start":{"line":91,"column":1,"offset":3213},"end":{"line":101,"column":66,"offset":3672}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Asynchronous with Streams","position":{"start":{"line":103,"column":4,"offset":3677},"end":{"line":103,"column":29,"offset":3702}}}],"position":{"start":{"line":103,"column":1,"offset":3674},"end":{"line":103,"column":29,"offset":3702}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">cudaStream_t stream1<span class=\"token punctuation\">,</span> stream2<span class=\"token punctuation\">,</span> stream3<span class=\"token punctuation\">,</span> stream4 <span class=\"token punctuation\">;</span>\ncudaStreamCreate <span class=\"token punctuation\">(</span> <span class=\"token operator\">&amp;</span>stream1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\ncudaMalloc <span class=\"token punctuation\">(</span> <span class=\"token operator\">&amp;</span>dev1<span class=\"token punctuation\">,</span> size <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\ncudaMallocHost <span class=\"token punctuation\">(</span> <span class=\"token operator\">&amp;</span>host1<span class=\"token punctuation\">,</span> size <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span> <span class=\"token comment\">// pinned memory required on host</span>\n…\ncudaMemcpyAsync <span class=\"token punctuation\">(</span> dev1<span class=\"token punctuation\">,</span> host1<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> H2D<span class=\"token punctuation\">,</span> stream1 <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\nkernel2 <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> grid<span class=\"token punctuation\">,</span> block<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stream2 <span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span> …<span class=\"token punctuation\">,</span> dev2<span class=\"token punctuation\">,</span> … <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\nkernel3 <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> grid<span class=\"token punctuation\">,</span> block<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stream3 <span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span> …<span class=\"token punctuation\">,</span> dev3<span class=\"token punctuation\">,</span> … <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\ncudaMemcpyAsync <span class=\"token punctuation\">(</span> host4<span class=\"token punctuation\">,</span> dev4<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> D2H<span class=\"token punctuation\">,</span> stream4 <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\nsome_CPU_method <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>","position":{"start":{"line":105,"column":1,"offset":3704},"end":{"line":118,"column":4,"offset":4142}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The use of different, non-default streams make the code above fully asynchronous/concurrent. The four streams are potentially overlapped.","position":{"start":{"line":120,"column":1,"offset":4144},"end":{"line":120,"column":138,"offset":4281}}}],"position":{"start":{"line":120,"column":1,"offset":4144},"end":{"line":120,"column":138,"offset":4281}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{},"children":[{"type":"text","value":"special note","position":{"start":{"line":122,"column":6,"offset":4288},"end":{"line":122,"column":18,"offset":4300}}}],"position":{"start":{"line":122,"column":1,"offset":4283},"end":{"line":122,"column":18,"offset":4300}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note that: ","position":{"start":{"line":124,"column":1,"offset":4302},"end":{"line":124,"column":12,"offset":4313}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"data","position":{"start":{"line":124,"column":14,"offset":4315},"end":{"line":124,"column":18,"offset":4319}}}],"position":{"start":{"line":124,"column":12,"offset":4313},"end":{"line":124,"column":20,"offset":4321}}},{"type":"text","value":" used by concurrent operations should be ","position":{"start":{"line":124,"column":20,"offset":4321},"end":{"line":124,"column":61,"offset":4362}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"independent","position":{"start":{"line":124,"column":63,"offset":4364},"end":{"line":124,"column":74,"offset":4375}}}],"position":{"start":{"line":124,"column":61,"offset":4362},"end":{"line":124,"column":76,"offset":4377}}},{"type":"text","value":".","position":{"start":{"line":124,"column":76,"offset":4377},"end":{"line":124,"column":77,"offset":4378}}}],"position":{"start":{"line":124,"column":1,"offset":4302},"end":{"line":124,"column":77,"offset":4378}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Overlap Computation and Data Transfers","position":{"start":{"line":126,"column":4,"offset":4383},"end":{"line":126,"column":42,"offset":4421}}}],"position":{"start":{"line":126,"column":1,"offset":4380},"end":{"line":126,"column":42,"offset":4421}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> nStreams<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> offset <span class=\"token operator\">=</span> i <span class=\"token operator\">*</span> streamSize<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">cudaMemcpyAsync</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>d_a<span class=\"token punctuation\">[</span>offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>a<span class=\"token punctuation\">[</span>offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> streamBytes<span class=\"token punctuation\">,</span> cudaMemcpyHostToDevice<span class=\"token punctuation\">,</span> stream<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  kernel<span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span>streamSize<span class=\"token operator\">/</span>blockSize<span class=\"token punctuation\">,</span> blockSize<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> stream<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>d_a<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">cudaMemcpyAsync</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>a<span class=\"token punctuation\">[</span>offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>d_a<span class=\"token punctuation\">[</span>offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> streamBytes<span class=\"token punctuation\">,</span> cudaMemcpyDeviceToHost<span class=\"token punctuation\">,</span> stream<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":128,"column":1,"offset":4423},"end":{"line":135,"column":4,"offset":4761}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the modified code, we break up the array of size N into chunks of streamSize elements. Since the kernel operates independently on all elements, each of the chunks can be processed independently.","position":{"start":{"line":137,"column":1,"offset":4763},"end":{"line":137,"column":198,"offset":4960}}}],"position":{"start":{"line":137,"column":1,"offset":4763},"end":{"line":137,"column":198,"offset":4960}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8ed12f93dd65d2f535290fa80bf564f7/9cc91/compute%26data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.409556313993175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAb0lEQVQI14XDvQrCMBSA0T62m4uzIAidXMRJELRXHAxomutPh7ZJbsTX+cQHEA+cSlU5O4e2V/rtnNJM6W4zjlazCifk2dMNhRRHUkp/VyEERATvPfn1xh4XTJaU/QSNC3bjms3dcWgjZpn8nX//AFqihCEiyOIbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"overlap computetion and data transfers\"\n        title=\"overlap computetion and data transfers\"\n        src=\"/static/8ed12f93dd65d2f535290fa80bf564f7/799d3/compute%26data.png\"\n        srcset=\"/static/8ed12f93dd65d2f535290fa80bf564f7/00d96/compute%26data.png 148w,\n/static/8ed12f93dd65d2f535290fa80bf564f7/0b23c/compute%26data.png 295w,\n/static/8ed12f93dd65d2f535290fa80bf564f7/799d3/compute%26data.png 590w,\n/static/8ed12f93dd65d2f535290fa80bf564f7/2a3d6/compute%26data.png 885w,\n/static/8ed12f93dd65d2f535290fa80bf564f7/9cc91/compute%26data.png 1172w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">overlap computetion and data transfers</figcaption>\n  </figure>","position":{"start":{"line":139,"column":1,"offset":4962},"end":{"line":139,"column":62,"offset":5023}}}],"position":{"start":{"line":139,"column":1,"offset":4962},"end":{"line":139,"column":62,"offset":5023}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The number of (non-default) streams used is ","position":{"start":{"line":141,"column":1,"offset":5025},"end":{"line":141,"column":45,"offset":5069}}},{"type":"raw","value":"<code class=\"language-text\">nStreams=N/streamSize</code>","position":{"start":{"line":141,"column":45,"offset":5069},"end":{"line":141,"column":68,"offset":5092}}},{"type":"text","value":". In the picture above there are 4 streams.","position":{"start":{"line":141,"column":68,"offset":5092},"end":{"line":141,"column":111,"offset":5135}}}],"position":{"start":{"line":141,"column":1,"offset":5025},"end":{"line":141,"column":111,"offset":5135}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Synchronization","position":{"start":{"line":143,"column":4,"offset":5140},"end":{"line":143,"column":19,"offset":5155}}}],"position":{"start":{"line":143,"column":1,"offset":5137},"end":{"line":143,"column":19,"offset":5155}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Explicit","position":{"start":{"line":145,"column":5,"offset":5161},"end":{"line":145,"column":13,"offset":5169}}}],"position":{"start":{"line":145,"column":1,"offset":5157},"end":{"line":145,"column":13,"offset":5169}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Synchronize everything","position":{"start":{"line":147,"column":3,"offset":5173},"end":{"line":147,"column":25,"offset":5195}}}],"position":{"start":{"line":147,"column":3,"offset":5173},"end":{"line":147,"column":25,"offset":5195}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaDeviceSynchronize ()","position":{"start":{"line":149,"column":5,"offset":5201},"end":{"line":149,"column":29,"offset":5225}}}],"position":{"start":{"line":149,"column":3,"offset":5199},"end":{"line":149,"column":29,"offset":5225}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Blocks host until all issued CUDA calls are complete","position":{"start":{"line":150,"column":5,"offset":5230},"end":{"line":150,"column":57,"offset":5282}}}],"position":{"start":{"line":150,"column":3,"offset":5228},"end":{"line":150,"column":57,"offset":5282}}},{"type":"text","value":"\n"}],"position":{"start":{"line":149,"column":3,"offset":5199},"end":{"line":150,"column":57,"offset":5282}}},{"type":"text","value":"\n"}],"position":{"start":{"line":147,"column":1,"offset":5171},"end":{"line":151,"column":1,"offset":5283}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Synchronize w.r.t. a specific stream","position":{"start":{"line":152,"column":3,"offset":5286},"end":{"line":152,"column":39,"offset":5322}}}],"position":{"start":{"line":152,"column":3,"offset":5286},"end":{"line":152,"column":39,"offset":5322}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaStreamSynchronize ( streamid )","position":{"start":{"line":154,"column":5,"offset":5328},"end":{"line":154,"column":39,"offset":5362}}}],"position":{"start":{"line":154,"column":3,"offset":5326},"end":{"line":154,"column":39,"offset":5362}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Blocks host until all CUDA calls in streamid are complete","position":{"start":{"line":155,"column":5,"offset":5367},"end":{"line":155,"column":62,"offset":5424}}}],"position":{"start":{"line":155,"column":3,"offset":5365},"end":{"line":155,"column":62,"offset":5424}}},{"type":"text","value":"\n"}],"position":{"start":{"line":154,"column":3,"offset":5326},"end":{"line":155,"column":62,"offset":5424}}},{"type":"text","value":"\n"}],"position":{"start":{"line":152,"column":1,"offset":5284},"end":{"line":156,"column":1,"offset":5425}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Synchronize using Events","position":{"start":{"line":157,"column":3,"offset":5428},"end":{"line":157,"column":27,"offset":5452}}}],"position":{"start":{"line":157,"column":3,"offset":5428},"end":{"line":157,"column":27,"offset":5452}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Create specific ‘Events’, within streams, to use for synchronization","position":{"start":{"line":158,"column":5,"offset":5457},"end":{"line":158,"column":73,"offset":5525}}}],"position":{"start":{"line":158,"column":3,"offset":5455},"end":{"line":158,"column":73,"offset":5525}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaEventRecord ( event, streamid )","position":{"start":{"line":159,"column":5,"offset":5530},"end":{"line":159,"column":40,"offset":5565}}}],"position":{"start":{"line":159,"column":3,"offset":5528},"end":{"line":159,"column":40,"offset":5565}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaEventSynchronize ( event )","position":{"start":{"line":160,"column":5,"offset":5570},"end":{"line":160,"column":35,"offset":5600}}}],"position":{"start":{"line":160,"column":3,"offset":5568},"end":{"line":160,"column":35,"offset":5600}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaStreamWaitEvent ( stream, event )","position":{"start":{"line":161,"column":5,"offset":5605},"end":{"line":161,"column":42,"offset":5642}}}],"position":{"start":{"line":161,"column":3,"offset":5603},"end":{"line":161,"column":42,"offset":5642}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaEventQuery ( event )","position":{"start":{"line":162,"column":5,"offset":5647},"end":{"line":162,"column":29,"offset":5671}}}],"position":{"start":{"line":162,"column":3,"offset":5645},"end":{"line":162,"column":29,"offset":5671}}},{"type":"text","value":"\n"}],"position":{"start":{"line":158,"column":3,"offset":5455},"end":{"line":162,"column":29,"offset":5671}}},{"type":"text","value":"\n"}],"position":{"start":{"line":157,"column":1,"offset":5426},"end":{"line":162,"column":29,"offset":5671}}},{"type":"text","value":"\n"}],"position":{"start":{"line":147,"column":1,"offset":5171},"end":{"line":162,"column":29,"offset":5671}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{},"children":[{"type":"text","value":"example","position":{"start":{"line":164,"column":6,"offset":5678},"end":{"line":164,"column":13,"offset":5685}}}],"position":{"start":{"line":164,"column":1,"offset":5673},"end":{"line":164,"column":13,"offset":5685}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">{</span>\n cudaEvent_t event<span class=\"token punctuation\">;</span>\n cudaEventCreate <span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// create event</span>\n\n cudaMemcpyAsync <span class=\"token punctuation\">(</span> d_in<span class=\"token punctuation\">,</span> in<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> H2D<span class=\"token punctuation\">,</span> stream1 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1) H2D copy of new input</span>\n cudaEventRecord <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> stream1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// record event</span>\n\n cudaMemcpyAsync <span class=\"token punctuation\">(</span> out<span class=\"token punctuation\">,</span> d_out<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> D2H<span class=\"token punctuation\">,</span> stream2 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2) D2H copy of previous result</span>\n cudaStreamWaitEvent <span class=\"token punctuation\">(</span> stream2<span class=\"token punctuation\">,</span> event <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// wait for event in stream1</span>\n\n kernel <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> stream2 <span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span> d_in<span class=\"token punctuation\">,</span> d_out <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3) must wait for 1 and 2</span>\n asynchronousCPUmethod <span class=\"token punctuation\">(</span> … <span class=\"token punctuation\">)</span> <span class=\"token comment\">// Async GPU method</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":166,"column":1,"offset":5687},"end":{"line":180,"column":4,"offset":6176}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Implicit","position":{"start":{"line":182,"column":5,"offset":6182},"end":{"line":182,"column":13,"offset":6190}}}],"position":{"start":{"line":182,"column":1,"offset":6178},"end":{"line":182,"column":13,"offset":6190}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"These operations implicitly synchronize all other CUDA operations","position":{"start":{"line":184,"column":1,"offset":6192},"end":{"line":184,"column":66,"offset":6257}}}],"position":{"start":{"line":184,"column":1,"offset":6192},"end":{"line":184,"column":66,"offset":6257}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Page-locked memory allocation","position":{"start":{"line":186,"column":3,"offset":6261},"end":{"line":186,"column":32,"offset":6290}}}],"position":{"start":{"line":186,"column":3,"offset":6261},"end":{"line":186,"column":32,"offset":6290}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMallocHost","position":{"start":{"line":188,"column":5,"offset":6296},"end":{"line":188,"column":19,"offset":6310}}}],"position":{"start":{"line":188,"column":3,"offset":6294},"end":{"line":188,"column":19,"offset":6310}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaHostAlloc","position":{"start":{"line":189,"column":5,"offset":6315},"end":{"line":189,"column":18,"offset":6328}}}],"position":{"start":{"line":189,"column":3,"offset":6313},"end":{"line":189,"column":18,"offset":6328}}},{"type":"text","value":"\n"}],"position":{"start":{"line":188,"column":3,"offset":6294},"end":{"line":189,"column":18,"offset":6328}}},{"type":"text","value":"\n"}],"position":{"start":{"line":186,"column":1,"offset":6259},"end":{"line":190,"column":1,"offset":6329}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Device memory allocation","position":{"start":{"line":191,"column":3,"offset":6332},"end":{"line":191,"column":27,"offset":6356}}}],"position":{"start":{"line":191,"column":3,"offset":6332},"end":{"line":191,"column":27,"offset":6356}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMalloc","position":{"start":{"line":193,"column":5,"offset":6362},"end":{"line":193,"column":15,"offset":6372}}}],"position":{"start":{"line":193,"column":3,"offset":6360},"end":{"line":193,"column":15,"offset":6372}}},{"type":"text","value":"\n"}],"position":{"start":{"line":193,"column":3,"offset":6360},"end":{"line":193,"column":15,"offset":6372}}},{"type":"text","value":"\n"}],"position":{"start":{"line":191,"column":1,"offset":6330},"end":{"line":194,"column":1,"offset":6373}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Non-Async version of memory operations","position":{"start":{"line":195,"column":3,"offset":6376},"end":{"line":195,"column":41,"offset":6414}}}],"position":{"start":{"line":195,"column":3,"offset":6376},"end":{"line":195,"column":41,"offset":6414}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMemcpy","position":{"start":{"line":196,"column":5,"offset":6419},"end":{"line":196,"column":15,"offset":6429}}},{"type":"text","value":"*","position":{"start":{"line":196,"column":15,"offset":6429},"end":{"line":196,"column":17,"offset":6431}}},{"type":"text","value":" (no Async suffix)","position":{"start":{"line":196,"column":17,"offset":6431},"end":{"line":196,"column":35,"offset":6449}}}],"position":{"start":{"line":196,"column":3,"offset":6417},"end":{"line":196,"column":35,"offset":6449}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaMemset","position":{"start":{"line":197,"column":5,"offset":6454},"end":{"line":197,"column":15,"offset":6464}}},{"type":"text","value":"*","position":{"start":{"line":197,"column":15,"offset":6464},"end":{"line":197,"column":17,"offset":6466}}},{"type":"text","value":" (no Async suffix)","position":{"start":{"line":197,"column":17,"offset":6466},"end":{"line":197,"column":35,"offset":6484}}}],"position":{"start":{"line":197,"column":3,"offset":6452},"end":{"line":197,"column":35,"offset":6484}}},{"type":"text","value":"\n"}],"position":{"start":{"line":196,"column":3,"offset":6417},"end":{"line":197,"column":35,"offset":6484}}},{"type":"text","value":"\n"}],"position":{"start":{"line":195,"column":1,"offset":6374},"end":{"line":197,"column":35,"offset":6484}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Change to L1/shared memory configuration","position":{"start":{"line":198,"column":3,"offset":6487},"end":{"line":198,"column":43,"offset":6527}}}],"position":{"start":{"line":198,"column":3,"offset":6487},"end":{"line":198,"column":43,"offset":6527}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cudaDeviceSetCacheConfig","position":{"start":{"line":199,"column":5,"offset":6532},"end":{"line":199,"column":29,"offset":6556}}}],"position":{"start":{"line":199,"column":3,"offset":6530},"end":{"line":199,"column":29,"offset":6556}}},{"type":"text","value":"\n"}],"position":{"start":{"line":199,"column":3,"offset":6530},"end":{"line":199,"column":29,"offset":6556}}},{"type":"text","value":"\n"}],"position":{"start":{"line":198,"column":1,"offset":6485},"end":{"line":199,"column":29,"offset":6556}}},{"type":"text","value":"\n"}],"position":{"start":{"line":186,"column":1,"offset":6259},"end":{"line":199,"column":29,"offset":6556}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Measure Performance Gain","position":{"start":{"line":201,"column":4,"offset":6561},"end":{"line":201,"column":28,"offset":6585}}}],"position":{"start":{"line":201,"column":1,"offset":6558},"end":{"line":201,"column":28,"offset":6585}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/6e7e2/interleave.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.193548387096776%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACH0lEQVQoz02SW08UQRBGe6Z7emd67tfd2V1QWVgElxjigwgS0BcVEU24hEhM1Gff/fnH2oVEHk6qeqb7S9VXpVymGM09ug2P4aaSKMwU4x1F/1wRJgrPU/ha8O/xHkf5rpQicoaTsw2UHXgMYrXC5R5htjx7RNl9bow8EkHt/4/mMSKo5Y5zlvGkFUFr6UdjxuMpLjK0raZpNHXtS/QpOkPaCLUh6zSuybBlLVTYqsEWBQMpygT3wipJLNNpx3A4ou8NNzeGyyvL1bXm5tZweJuzuCjY+1Lw6jqmPz/FnPzGnnwneP+L8OAraaIpKkecGlQQGGnLZxAq4lhLrtHaiCeBXNCCj5PoEn9FmmnyQpPlmlQoK0vdOqbrDVkZoCI3IEkyabVlIh5UbU6cFOJJSdt1jPqStUnK+tOKyXpNUVsaESwKs6J5EI/F70xyNRwl0nLP1nzG64M5bw57jo5mHB/P+Hi2zdsPW+y9O2Xxcpf9vSnDcUIhlSxE7DA39FVALhS1IFHVreXZrJUKhlJhwOczxSfh4pvi/EKx/zFi48855d1P7OwFqVhQFop1eTwrZYhLwfpBUFBlFUlblQylI4kTbCjeZZYwCmXXQtkxQ14qdi632P57R3X1g2S2TVp6xCKWlcv/mkRWLq9kKM5F4lcohhsq8adqQmkpJXaO1cACvRLPnMeTXZ/+aEG6uUtVLSdr6YYy+XHGfGeNsh7wDx/W9WHF5jZtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"interleave\"\n        title=\"interleave\"\n        src=\"/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/799d3/interleave.png\"\n        srcset=\"/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/00d96/interleave.png 148w,\n/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/0b23c/interleave.png 295w,\n/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/799d3/interleave.png 590w,\n/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/2a3d6/interleave.png 885w,\n/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/ae92f/interleave.png 1180w,\n/static/abac83195ebc6cd43dd0e4a6ca8bf8c5/6e7e2/interleave.png 1984w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">interleave</figcaption>\n  </figure>","position":{"start":{"line":203,"column":1,"offset":6587},"end":{"line":203,"column":32,"offset":6618}}}],"position":{"start":{"line":203,"column":1,"offset":6587},"end":{"line":203,"column":32,"offset":6618}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c4b7386740970ea3d09914e128fd5e5f/3c1f0/moreinterleave.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.14914914914915%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACQklEQVQozz2SSU8bQRCFe1Z7Vo/Hy3iMNzzGdoKx2Q0OxAnIKISIAxJCicIxp0SJxDHHHPK3v9SAlcNT9VL16vXrUn6skQ41kkyj2lXUM0UyUNT6L+soVWiaQtfXMNZYrw1DQylFXHdYfsxQdlGjGCgKvsKR6JU0vEgXvERX9qaVIy9WKCHXhEzlUC/N8ugHDmmziioUijSSJu1Wl3I5xjINTEPHks62qZ5RKGgUirrc+2z2ujSTBj0pzvotOt3mM5HjmBiSqwJhns8Trq9Tzs5jBochg7lHd9HAnZ5TnL2j2MmkQJ4f26zu65x+v6K6eEuj16TTqVFPSqLQwvUMlOt67O13WF1tcXHZZ385Y2d+zGjUYTQdk2Yd3KgoVhhEgcZDT/F0W+BhNWGjFqOJFa6ce6GBLznKtk3abY2DA1uU2gwvNkhuL/Gnx/jlgChShJFBWDZppAE77SaDqMZ+ErLTj8mGKVHFfr7PoWp1V4y20JRBEIpsxyaILRrnE0qDTAg1ompeYIlXDp8eUm5/9jj+dka2uhEfu8ShohybYomFajQDFm+6vL05Yrw7Z7i5yeT1kPEgZTRsiaoEP7T/q0gHOuf3Jnd/K8z/zKh9ucTefoVTKUiOEIYlh8m2w510Pfn1gerJKdVWWbp5OOKvoRtYlqiWvJoULEXJMjD4PDb4/Wjw9CPm6+MhR7t7lMrioec72DI6UahxtNDpvJ9gJ33M9XzlA+y4Yrj4GAkmFZ2pYCwfMA5NtmVOZ+LzljTLP+UfHuT+rpCbE/UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"moreinterleave\"\n        title=\"moreinterleave\"\n        src=\"/static/c4b7386740970ea3d09914e128fd5e5f/799d3/moreinterleave.png\"\n        srcset=\"/static/c4b7386740970ea3d09914e128fd5e5f/00d96/moreinterleave.png 148w,\n/static/c4b7386740970ea3d09914e128fd5e5f/0b23c/moreinterleave.png 295w,\n/static/c4b7386740970ea3d09914e128fd5e5f/799d3/moreinterleave.png 590w,\n/static/c4b7386740970ea3d09914e128fd5e5f/2a3d6/moreinterleave.png 885w,\n/static/c4b7386740970ea3d09914e128fd5e5f/ae92f/moreinterleave.png 1180w,\n/static/c4b7386740970ea3d09914e128fd5e5f/3c1f0/moreinterleave.png 1998w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">moreinterleave</figcaption>\n  </figure>","position":{"start":{"line":205,"column":1,"offset":6620},"end":{"line":205,"column":40,"offset":6659}}}],"position":{"start":{"line":205,"column":1,"offset":6620},"end":{"line":205,"column":40,"offset":6659}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To read more about concurrency and streams:\n","position":{"start":{"line":207,"column":1,"offset":6661},"end":{"line":208,"column":1,"offset":6705}}},{"type":"element","tagName":"a","properties":{"href":"https://developer.download.nvidia.com/CUDA/training/StreamsAndConcurrencyWebinar.pdf"},"children":[{"type":"text","value":"https://developer.download.nvidia.com/CUDA/training/StreamsAndConcurrencyWebinar.pdf","position":{"start":{"line":208,"column":1,"offset":6705},"end":{"line":208,"column":85,"offset":6789}}}],"position":{"start":{"line":208,"column":1,"offset":6705},"end":{"line":208,"column":85,"offset":6789}}},{"type":"text","value":"\n","position":{"start":{"line":208,"column":85,"offset":6789},"end":{"line":209,"column":1,"offset":6790}}},{"type":"element","tagName":"a","properties":{"href":"https://devblogs.nvidia.com/how-overlap-data-transfers-cuda-cc/"},"children":[{"type":"text","value":"https://devblogs.nvidia.com/how-overlap-data-transfers-cuda-cc/","position":{"start":{"line":209,"column":1,"offset":6790},"end":{"line":209,"column":64,"offset":6853}}}],"position":{"start":{"line":209,"column":1,"offset":6790},"end":{"line":209,"column":64,"offset":6853}}}],"position":{"start":{"line":207,"column":1,"offset":6661},"end":{"line":209,"column":64,"offset":6853}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":210,"column":1,"offset":6854}}}}