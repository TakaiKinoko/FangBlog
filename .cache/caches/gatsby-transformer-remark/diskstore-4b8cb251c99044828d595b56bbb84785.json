{
  "expireTime": 9007200830643999000,
  "key": "transformer-remark-markdown-ast-cf1a50d7d8d3abd3d02407e8726ae5f4-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-reading-time-",
  "val": {
    "type": "root",
    "children": [
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In the previous posts, we have sometimes assumed that only one kernel is launched at a time. But this is not all that kernels can do. They can be launched ",
            "position": {
              "start": { "line": 2, "column": 1, "offset": 1 },
              "end": { "line": 2, "column": 156, "offset": 156 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "sequentially",
                "position": {
                  "start": { "line": 2, "column": 158, "offset": 158 },
                  "end": { "line": 2, "column": 170, "offset": 170 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 2, "column": 156, "offset": 156 },
              "end": { "line": 2, "column": 172, "offset": 172 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " or ",
            "position": {
              "start": { "line": 2, "column": 172, "offset": 172 },
              "end": { "line": 2, "column": 176, "offset": 176 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "in parallel",
                "position": {
                  "start": { "line": 2, "column": 178, "offset": 178 },
                  "end": { "line": 2, "column": 189, "offset": 189 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 2, "column": 176, "offset": 176 },
              "end": { "line": 2, "column": 191, "offset": 191 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": ". Itâ€™s just that if multiple kernels are launched in parallel, CUDA streams must be used.",
            "position": {
              "start": { "line": 2, "column": 191, "offset": 191 },
              "end": { "line": 2, "column": 280, "offset": 280 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 2, "column": 1, "offset": 1 },
          "end": { "line": 2, "column": 280, "offset": 280 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Motivation",
            "position": {
              "start": { "line": 4, "column": 4, "offset": 285 },
              "end": { "line": 4, "column": 14, "offset": 295 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 4, "column": 1, "offset": 282 },
          "end": { "line": 4, "column": 14, "offset": 295 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "Heterogeneous computing",
                "position": {
                  "start": { "line": 6, "column": 3, "offset": 299 },
                  "end": { "line": 6, "column": 26, "offset": 322 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 6, "column": 1, "offset": 297 },
              "end": { "line": 6, "column": 28, "offset": 324 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " is about efficiently using all processors in the system, including CPUs and GPUs.",
            "position": {
              "start": { "line": 6, "column": 28, "offset": 324 },
              "end": { "line": 6, "column": 110, "offset": 406 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 6, "column": 1, "offset": 297 },
          "end": { "line": 6, "column": 110, "offset": 406 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "To do this, applications must ",
            "position": {
              "start": { "line": 8, "column": 1, "offset": 408 },
              "end": { "line": 8, "column": 31, "offset": 438 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "execute functions concurrently",
                "position": {
                  "start": { "line": 8, "column": 33, "offset": 440 },
                  "end": { "line": 8, "column": 63, "offset": 470 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 8, "column": 31, "offset": 438 },
              "end": { "line": 8, "column": 65, "offset": 472 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " on multiple processors. ",
            "position": {
              "start": { "line": 8, "column": 65, "offset": 472 },
              "end": { "line": 8, "column": 90, "offset": 497 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 8, "column": 1, "offset": 408 },
          "end": { "line": 8, "column": 90, "offset": 497 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "CUDA Applications manage concurrency by executing asynchronous commands in streams, sequences of commands that execute in order. Different streams may execute their commands concurrently or out of order with respect to each other",
            "position": {
              "start": { "line": 10, "column": 1, "offset": 499 },
              "end": { "line": 10, "column": 230, "offset": 728 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 10, "column": 1, "offset": 499 },
          "end": { "line": 10, "column": 230, "offset": 728 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "What is a Stream?",
            "position": {
              "start": { "line": 12, "column": 4, "offset": 733 },
              "end": { "line": 12, "column": 21, "offset": 750 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 12, "column": 1, "offset": 730 },
          "end": { "line": 12, "column": 21, "offset": 750 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In CUDA, stream refers to ",
            "position": {
              "start": { "line": 14, "column": 1, "offset": 752 },
              "end": { "line": 14, "column": 27, "offset": 778 },
              "indent": []
            }
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "a single operation sequence",
                "position": {
                  "start": { "line": 14, "column": 29, "offset": 780 },
                  "end": { "line": 14, "column": 56, "offset": 807 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 14, "column": 27, "offset": 778 },
              "end": { "line": 14, "column": 58, "offset": 809 },
              "indent": []
            }
          },
          {
            "type": "text",
            "value": " on a GPU device.",
            "position": {
              "start": { "line": 14, "column": 58, "offset": 809 },
              "end": { "line": 14, "column": 75, "offset": 826 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 14, "column": 1, "offset": 752 },
          "end": { "line": 14, "column": 75, "offset": 826 },
          "indent": []
        }
      },
      {
        "type": "list",
        "ordered": false,
        "start": null,
        "loose": true,
        "children": [
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "Every CUDA kernel is invoked on an independent stream",
                    "position": {
                      "start": { "line": 16, "column": 3, "offset": 830 },
                      "end": { "line": 16, "column": 56, "offset": 883 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 16, "column": 3, "offset": 830 },
                  "end": { "line": 16, "column": 56, "offset": 883 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 16, "column": 1, "offset": 828 },
              "end": { "line": 17, "column": 1, "offset": 884 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": true,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "If only one kernel is invoked, the default stream, stream0, is used",
                    "position": {
                      "start": { "line": 18, "column": 3, "offset": 887 },
                      "end": { "line": 18, "column": 70, "offset": 954 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 18, "column": 3, "offset": 887 },
                  "end": { "line": 18, "column": 70, "offset": 954 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 18, "column": 1, "offset": 885 },
              "end": { "line": 19, "column": 1, "offset": 955 },
              "indent": [1]
            }
          },
          {
            "type": "listItem",
            "loose": false,
            "checked": null,
            "children": [
              {
                "type": "paragraph",
                "children": [
                  {
                    "type": "text",
                    "value": "If n kernels are invoked in parallel, n streams need to be used",
                    "position": {
                      "start": { "line": 20, "column": 3, "offset": 958 },
                      "end": { "line": 20, "column": 66, "offset": 1021 },
                      "indent": []
                    }
                  }
                ],
                "position": {
                  "start": { "line": 20, "column": 3, "offset": 958 },
                  "end": { "line": 20, "column": 66, "offset": 1021 },
                  "indent": []
                }
              }
            ],
            "position": {
              "start": { "line": 20, "column": 1, "offset": 956 },
              "end": { "line": 20, "column": 66, "offset": 1021 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 16, "column": 1, "offset": 828 },
          "end": { "line": 20, "column": 66, "offset": 1021 },
          "indent": [1, 1, 1, 1]
        }
      },
      {
        "type": "html",
        "lang": "c",
        "value": "<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">  kernel<span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> blocks<span class=\"token punctuation\">,</span> threads<span class=\"token punctuation\">,</span> bytes <span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// default stream</span>\n  kernel<span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">&lt;</span> blocks<span class=\"token punctuation\">,</span> threads<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// stream 0</span></code></pre></div>",
        "position": {
          "start": { "line": 22, "column": 1, "offset": 1023 },
          "end": { "line": 25, "column": 4, "offset": 1151 },
          "indent": [1, 1, 1]
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "In CUDA, we can run multiple kernels on different streams concurrently. Typically, we can improve performance by increasing number of concurrent streams by setting a higher degree of parallelism.",
            "position": {
              "start": { "line": 27, "column": 1, "offset": 1153 },
              "end": { "line": 27, "column": 196, "offset": 1348 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 27, "column": 1, "offset": 1153 },
          "end": { "line": 27, "column": 196, "offset": 1348 },
          "indent": []
        }
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Between Streams",
            "position": {
              "start": { "line": 29, "column": 4, "offset": 1353 },
              "end": { "line": 29, "column": 19, "offset": 1368 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 29, "column": 1, "offset": 1350 },
          "end": { "line": 29, "column": 19, "offset": 1368 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The concurrent streams are independent, which means that streams neither communicate nor have any inter-stream dependency.",
            "position": {
              "start": { "line": 30, "column": 1, "offset": 1369 },
              "end": { "line": 30, "column": 123, "offset": 1491 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 30, "column": 1, "offset": 1369 },
          "end": { "line": 30, "column": 123, "offset": 1491 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "However, different streams may have different execution times, and we cannot guarantee that all streams will complete at the same time. To ensure all streams are synchronized, use a synchronization barrier.",
            "position": {
              "start": { "line": 32, "column": 1, "offset": 1493 },
              "end": { "line": 32, "column": 207, "offset": 1699 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 32, "column": 1, "offset": 1493 },
          "end": { "line": 32, "column": 207, "offset": 1699 },
          "indent": []
        }
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "There are two types of stream synchronization in CUDA. A programmer can place the synchronization barrier explicitly, to synchronize tasks such as memory operations. Some functions are implicitly synchronized, which means one or all streams must complete before proceeding to the next section.",
            "position": {
              "start": { "line": 34, "column": 1, "offset": 1701 },
              "end": { "line": 34, "column": 294, "offset": 1994 },
              "indent": []
            }
          }
        ],
        "position": {
          "start": { "line": 34, "column": 1, "offset": 1701 },
          "end": { "line": 34, "column": 294, "offset": 1994 },
          "indent": []
        }
      }
    ],
    "position": {
      "start": { "line": 1, "column": 1, "offset": 0 },
      "end": { "line": 34, "column": 294, "offset": 1994 }
    }
  }
}
