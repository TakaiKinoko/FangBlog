{
  "expireTime": 9007200830564692000,
  "key": "transformer-remark-markdown-html-045327eb4e9b3c083ad2362f5a0455b2-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-reading-time-",
  "val": "<p>I recently had to pack a project with <strong>Reprozip</strong> where all the dependencies can be nicely preserved. Reprozip uses ptrace and thus only works on Linux, which means I had to set up a linux environment on my Mac. I mean, you canâ€™t call yourself a software engineer without having a Linux (virtual) machine, can you?! ðŸ˜“</p>\n<p>In case someone out there are faced with the same task, Iâ€™ve documented my setup process in this post.</p>\n<h2>My Environment</h2>\n<p>macOS Catalina 10.15.1</p>\n<h2>Install Reprozip</h2>\n<h3>Install VirtualBox Or Equivalent</h3>\n<p>Vagrant needs VirtualBox to run.</p>\n<p>Download installer here: <a href=\"https://www.virtualbox.org/wiki/Downloads\">https://www.virtualbox.org/wiki/Downloads</a></p>\n<p>If the installer failed, you may need to enable its kernel extension in: <strong>System Preferences â†’ Security &#x26; Privacy â†’ General</strong></p>\n<h3>Install Vagrant Or Equivalent</h3>\n<p>Download the installer for MacOS from <a href=\"https://www.vagrantup.com/downloads.html\">https://www.vagrantup.com/downloads.html</a>.</p>\n<p>Click, install, done.</p>\n<p>Then create <code class=\"language-text\">Vagrantfile</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant init hashicorp/bionic64</code></pre></div>\n<p>Set up VM:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant up</code></pre></div>\n<p>After running the above two commands, you will have a fully running virtual machine in VirtualBox running Ubuntu 12.04 LTS 64-bit.</p>\n<h3>ssh into VM</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant ssh</code></pre></div>\n<h3>Set up virtualenv</h3>\n<p><strong>IMPORTANT</strong>: make sure to run an update on the package index in the VM before procedding:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo apt update</code></pre></div>\n<h4>install <code class=\"language-text\">virtualenv</code> with <code class=\"language-text\">pip</code></h4>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo apt install virtualenv</code></pre></div>\n<p>check if installation was successful:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ virtualenv --version</code></pre></div>\n<h4>create an env</h4>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ virtualenv -p /usr/bin/python &lt;name&gt;</code></pre></div>\n<h4>activate an env</h4>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ source DBenv/bin/activate</code></pre></div>\n<h3>Install Pre-reqs For Reprozip</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo apt-get install python-dev\n$ sudo apt-get install python-pip\n$ sudo apt-get install sqlite3\n$ sudo apt-get install libsqlite3-dev</code></pre></div>\n<h3>Finally, Install Reprozip</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ pip install reprozip\n$ pip install reprounzip</code></pre></div>\n<h2>Run Reprozip</h2>\n<h3>Bring The Executable Into The Environment For Packaging</h3>\n<p>In order to use <code class=\"language-text\">scp</code>, we need to install a plugin:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant plugin install vagrant-scp</code></pre></div>\n<p>Note that this goes from <strong>local</strong> to <strong>linux</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant scp &lt;local_path&gt; [vm_name]:&lt;remote_path&gt;</code></pre></div>\n<p>More about how scp in/out of a Vagrant VM: <a href=\"https://github.com/invernizzi/vagrant-scp\">https://github.com/invernizzi/vagrant-scp</a>.</p>\n<p>In case you didnâ€™t know your <strong>[vm_name]</strong> just like myself, hereâ€™s how you track it down:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant status</code></pre></div>\n<h3>Run Trace and Pack</h3>\n<p>Weâ€™ll first trace all the system calls in execution by using Reprozip trace command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ reprozip trace &lt;command&gt;</code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a55b2973a385e178d5d84a2b4aa6d409/ba061/reprotrace.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 35.62970936490851%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABI0lEQVQoz4WR6Y6CMBRGeQ5kFRcISAiCQCxLQdxwElFn3v9NvuF2gtHEZH6c3PYmPf16K/Vdg0vf4Xy+YH84ot0fcH38oL/dce1vuD++0V2+UHGOquLgdY1mt0PdNEOvBmM5tlsmYHkBaVO6CEsfSZIgCAKE6zVWqxVs28ZiscB0OoWqqpBl+Q1FUUSf6mQyEdBaKg8F0mKDNM2Q53Tb9k8chvB9H8vlErPZDIZhQNd1UU3TFJWEmqa9IZ2OJ/CqHoSpkMVxLEQEial6nvfs0QXz+VzwUch5hSRNhIiIokikIxzHeaajw5RwfCZBAtq/iiXGGLIsw3qYHUFCEpOQ5kiJaJbj4dc0HxOScDf8Wtu2qIcfLMsSruuKZJZliVTEf6KRX1GJ1D93e/o1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"reprozip trace\"\n        title=\"\"\n        src=\"/static/a55b2973a385e178d5d84a2b4aa6d409/d7711/reprotrace.png\"\n        srcset=\"/static/a55b2973a385e178d5d84a2b4aa6d409/a695b/reprotrace.png 148w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/2f273/reprotrace.png 295w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/d7711/reprotrace.png 590w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/5e66f/reprotrace.png 885w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/466de/reprotrace.png 1180w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/76253/reprotrace.png 1770w,\n/static/a55b2973a385e178d5d84a2b4aa6d409/ba061/reprotrace.png 1858w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ reprozip pack &lt;pack-name&gt;</code></pre></div>\n<p>It gives an .rpz file which can then be <code class=\"language-text\">scp</code>ed to other system environments and be unzipped and ran.</p>\n<h3>Terminate a VM</h3>\n<p>when you are done playing around, you can terminate the virtual machine with:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ vagrant destroy</code></pre></div>"
}
